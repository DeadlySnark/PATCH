@CUSTOM_CHARAMAKE(ARG)
;NOは適当に設定
NO:ARG = 0

;性別(1=女性 2= 男性 3=ふたなり)
TALENT:ARG:2 = 1
SIF ARG == 0
	TALENT:ARG:2 = 2
;気力、体力
MAXBASE:ARG:0 = 2000
BASE:ARG:0 = MAXBASE:ARG:0
MAXBASE:ARG:1 = 2000
BASE:ARG:1 = MAXBASE:ARG:1

CALL NAME_CUSTOM(ARG)

CALL CUSTOM_TERMINAL(ARG)

@CUSTOM_TERMINAL(ARG)
;排他処理
IF HAS_VAGINA(ARG)
	ABL:ARG:ホモっ気 = 0
	ABL:ARG:ゲイ中毒 = 0
	EXP:ARG:ゲイ経験 = 0
	SIF !(HAS_PENIS(ARG))
		EXP:ARG:射精経験 = 0
ELSE
	ABL:ARG:Ｖ感覚 = 0
	ABL:ARG:レズっ気 = 0
	ABL:ARG:レズ中毒 = 0
	EXP:ARG:レズ経験 = 0
	EXP:ARG:噴乳経験 = 0
	EXP:ARG:Ｖ経験 = 0
	EXP:ARG:Ｖ絶頂経験 = 0
	EXP:ARG:パイズリ経験 = 0
	EXP:ARG:Ｖ性交経験 = 0
	EXP:ARG:催眠Ｖ性交経験 = 0
	EXP:ARG:催眠搾乳経験 = 0
	EXP:ARG:Ｖ拡張経験 = 0
	EXP:ARG:浮気Ｖ性交経験 = 0
	TALENT:ARG:Ｖ感度 = 0
	TALENT:ARG:ヴァギナサイズ = 0
	TALENT:ARG:処女 = 0
	TALENT:ARG:母乳体質 = 0
	TALENT:ARG:バストサイズ = -2
ENDIF
IF HAS_PENIS(ARG)
	MAXBASE:ARG:精力 = 1000
	BASE:ARG:精力 = 1000
ELSE
	TALENT:ARG:童貞 = 0
	MAXBASE:ARG:精力 = 0
	BASE:ARG:精力 = 0
	TALENT:ARG:Ｐ感度 = 0
	TALENT:ARG:ペニスサイズ = 0
ENDIF
IF TALENT:ARG:処女 == 1
	ABL:ARG:Ｖ感覚 = 0
	EXP:ARG:Ｖ経験 = 0
	EXP:ARG:Ｖ絶頂経験 = 0
	EXP:ARG:Ｖ性交経験 = 0
	EXP:ARG:Ｖ拡張経験 = 0
	EXP:ARG:催眠Ｖ性交経験 = 0
	EXP:ARG:浮気Ｖ性交経験 = 0
ELSEIF HAS_VAGINA(ARG) && EXP:ARG:Ｖ経験 == 0 && EXP:ARG:Ｖ性交経験 == 0
	EXP:ARG:Ｖ経験 = 1
	EXP:ARG:Ｖ性交経験 = 1
ENDIF
IF TALENT:ARG:肉便器 == 1		;;公衆便所と肉便器を初期で両立させない
	TALENT:ARG:公衆便所 = 0		;;
ELSEIF TALENT:ARG:公衆便所 == 1	;;
	TALENT:ARG:肉便器 = 0		;;
ENDIF							;;
IF TALENT:ARG:肉便器 == 1		;;NTRと肉便器を初期で両立させない
	TALENT:ARG:NTR = 0			;;
ELSEIF TALENT:ARG:NTR == 1		;;
	TALENT:ARG:肉便器 = 0		;;
ENDIF							;;

DRAWLINE
PRINTSL NAME:ARG
PRINT STA 
CALL PRINT_COLORBAR, BASE:ARG:0, MAXBASE:ARG:0, 16, UNICODE(0x2585), UNICODE(0x2585), BARCOLORSET("赤"), RESULT:1
PRINTFORM  ({BASE:ARG:0,5}/{MAXBASE:ARG:0,5}) 
PRINT ENE 
CALL PRINT_COLORBAR, BASE:ARG:1, MAXBASE:ARG:1, 16, UNICODE(0x2585), UNICODE(0x2585), BARCOLORSET("緑"), RESULT:1
PRINTFORM  ({BASE:ARG:1,5}/{MAXBASE:ARG:1,5})
PRINTL 
CALL PRINT_STATE_ABL(ARG)
PRINTL 
CALL PRINT_STATE_TALENT(ARG)
PRINTL 
CALL PRINT_STATE_EXP(ARG)
PRINTL
DRAWLINE
;最終決定
IF LOCAL:100 == 1000
	DRAWLINE
	PRINTL Finished?
;名前の設定
ELSEIF LOCAL:100 == 1001
	CALL NAME_CUSTOM(ARG)
	LOCAL:100 = 0
	RESTART
;ベース設定
ELSEIF LOCAL:100 == 1002
	CALL BASE_CUSTOM(ARG)
;素質設定
ELSEIF LOCAL:100 == 1003
	CALL TALENT_CUSTOM(ARG,LOCAL:101)
;能力設定
ELSEIF LOCAL:100 == 1004
	CALL ABL_CUSTOM(ARG)
;経験設定
ELSEIF LOCAL:100 == 1005
	CALL EXP_CUSTOM(ARG)
ELSEIF LOCAL:100 == 1006
	CALL COPY_CUSTOM(ARG)
ENDIF

DRAWLINE
PRINTFORML [1000] - \@(LOCAL:100 == 1000) ? Yes　        　# Done　       　\@  [1001] - Name change       [1002] - STA and ENE settings
PRINTL [1003] - Talent settings  [1004] - Ability settings  [1005] - Experience settings  [1006] - Copy talents
INPUT
IF RESULT == 1000 && LOCAL:100 == 1000
;	SIF NO:MASTER == 0
	RETURN 0
ELSEIF RESULT >= 1000
	LOCAL:100 = RESULT
	RESTART
ENDIF
;ベース設定
IF LOCAL:100 == 1002
	IF RESULT == 0 && MAXBASE:ARG:0 > 1000
		MAXBASE:ARG:0 -= 100
	ELSEIF RESULT == 1 && MAXBASE:ARG:0 < 3000
		MAXBASE:ARG:0 += 100
	ELSEIF RESULT == 2 && MAXBASE:ARG:1 > 1000
		MAXBASE:ARG:1 -= 100
	ELSEIF RESULT == 3 && MAXBASE:ARG:1 < 3000
		MAXBASE:ARG:1 += 100
	ENDIF
	BASE:ARG:0 = MAXBASE:ARG:0
	BASE:ARG:1 = MAXBASE:ARG:1
	RESTART
;素質設定
ELSEIF LOCAL:100 == 1003
	;ページ送り
	SIF RESULT == 998 && LOCAL:101
		LOCAL:101 --
	SIF RESULT == 999
		LOCAL:101 ++
	SIF RESULT < 0 || RESULT > 500 || TALENTNAME:RESULT == ""
		RESTART
	;陥落素質ほか
	;;[肉便器]を追加。[管理人]は選べない
	SIF (RESULT >= 3 && RESULT <= 5) || RESULT == 9 || RESULT == 34 || (RESULT >= 72 && RESULT <= 76) || RESULT == 84 || RESULT == 85 || (RESULT >= 153 && RESULT <= 155) || RESULT == 38
		RESTART
	;性別
	IF RESULT == 2
		IF TALENT:ARG:RESULT == 3
			TALENT:ARG:RESULT = 1
			TALENT:ARG:バストサイズ = 0
		ELSEIF TALENT:ARG:RESULT == 2
			TALENT:ARG:RESULT ++
			TALENT:ARG:バストサイズ = 0
		ELSE
			TALENT:ARG:RESULT ++
		ENDIF
	;性別嗜好
	ELSEIF RESULT == 81
		IF TALENT:ARG:RESULT == 3
			TALENT:ARG:RESULT = -1
		ELSE
			TALENT:ARG:RESULT ++
		ENDIF
	;オンオフ型の素質
	ELSEIF TALENTNAME:RESULT == GET_TALENTNAME(RESULT,1) || RESULT == 0 || RESULT == 1
		TALENT:ARG:RESULT = !TALENT:ARG:RESULT
		;オンオフ型で別途追加が必要な素質
		;母乳体質
		IF RESULT == 149
			IF TALENT:ARG:RESULT
				MAXBASE:ARG:母乳 = 2000
			ELSE
				MAXBASE:ARG:母乳 = 0
			ENDIF
		ENDIF
		;体型
	ELSEIF RESULT == 100
		;体型が「小人(-5)」と「巨人(3)」の場合を独立処理
		IF TALENT:ARG:RESULT == -3
			TALENT:ARG:RESULT = -2
		ELSEIF TALENT:ARG:RESULT == 3
			TALENT:ARG:RESULT = -3
		ELSE
			TALENT:ARG:RESULT ++
		ENDIF
	;量的素質
	ELSE
		;性別
		IF LOCAL == 2
			IF TALENT:ARG:RESULT == 3
				TALENT:ARG:RESULT = 1
			ELSE
				TALENT:ARG:RESULT ++
			ENDIF
		;端まで行くと-1を掛ける
		ELSEIF STRLENS(GET_TALENTNAME(RESULT,TALENT:ARG:RESULT + 1)) || TALENT:ARG:RESULT == -1
			TALENT:ARG:RESULT ++
		ELSE
			TALENT:ARG:RESULT = -1 * TALENT:ARG:RESULT
		ENDIF
	ENDIF
;能力設定
ELSEIF LOCAL:100 == 1004
	LOCAL = RESULT / 2
	SIF LOCAL >= 100
		RESTART
	SIF !STRLENS(ABLNAME:LOCAL)
		RESTART
	;同性愛関係
	IF !(HAS_VAGINA(ARG)) && (LOCAL == 17 || LOCAL == 32)
		RESTART
	ELSEIF HAS_VAGINA(ARG) && (LOCAL == 18 || LOCAL == 33)
		RESTART
	ENDIF
	;中毒関係
	SIF LOCAL >= 30
		RESTART
	;奇数(+)
	IF RESULT % 2
		IF ABL:ARG:LOCAL >= 2
			RESTART
		ELSE
			ABL:ARG:LOCAL ++
		ENDIF
	;偶数(-)
	ELSE
		IF ABL:ARG:LOCAL <= 0
			RESTART
		ELSE
			ABL:ARG:LOCAL --
		ENDIF
	ENDIF
ELSEIF LOCAL:100 == 1005
	IF RESULT == 998
		FOR LOCAL,0,100
		SIF STRLENS(EXPNAME:LOCAL)
			EXP:ARG:(LOCAL) = 0
		NEXT
		RESTART
	ELSEIF RESULT == 999
		FOR LOCAL,0,100
		SIF STRLENS(EXPNAME:LOCAL)
			EXP:ARG:(LOCAL) = RAND:30
		NEXT
		RESTART
	ELSE
		LOCAL = RESULT
		SIF LOCAL >= 100
			RESTART
		SIF !STRLENS(EXPNAME:LOCAL)
			RESTART
		;同性愛関係
		IF !(HAS_VAGINA(ARG)) && LOCAL == 51
			RESTART
		ELSEIF HAS_VAGINA(ARG) && LOCAL == 52
			RESTART
		ENDIF
		PRINTFORM Please input a value for %EXPNAME:LOCAL%      
		PRINTBUTTON "[Cancel]",-1
		INPUT
		SIF RESULT < 0
			RESTART
		EXP:ARG:LOCAL = MIN(RESULT,50)
	ENDIF
ELSEIF LOCAL:100 == 1006
	
ENDIF
RESTART

;名前の設定
@NAME_CUSTOM(ARG)
PRINTL Please type your character name.
IF STRLENS(NAME:ARG)
	PRINTFORM Current name: %NAME:ARG%      
	PRINTBUTTON "[Don't change]",""
	PRINTL
ENDIF
INPUTS
IF ARG == 0 && RESULTS == ""
	NAME:ARG = %NAME:ARG%
ELSE
	NAME:ARG = %RESULTS%
ENDIF

PRINTL Please type character nickname.
IF STRLENS(CALLNAME:ARG)
	PRINTFORM Current nick: %CALLNAME:ARG%      
	PRINTBUTTON "[Don't change]",""
	PRINTL
ENDIF
INPUTS
IF ARG == 0 && RESULTS == ""
	CALLNAME:ARG = %CALLNAME:ARG%
ELSE
	CALLNAME:ARG = %RESULTS%
ENDIF

;ベースの設定
@BASE_CUSTOM(ARG)
PRINT STA 
CALL PRINT_COLORBAR, BASE:ARG:0, MAXBASE:ARG:0, 16, UNICODE(0x2585), UNICODE(0x2585), BARCOLORSET("赤"), RESULT:1
PRINTFORM  ({BASE:ARG:0,5}/{MAXBASE:ARG:0,5})
IF BASE:ARG:0 != 1000
	PRINTBUTTON "[−]", 0
ELSE
	SETCOLOR 色設定_設定_無効化
	PRINT [−]
	RESETCOLOR
ENDIF
IF BASE:ARG:0 != 3000
	PRINTBUTTON "[＋]", 1
ELSE
	SETCOLOR 色設定_設定_無効化
	PRINT [＋]
	RESETCOLOR
ENDIF
PRINTL
PRINT ENE 
CALL PRINT_COLORBAR, BASE:ARG:1, MAXBASE:ARG:1, 16, UNICODE(0x2585), UNICODE(0x2585), BARCOLORSET("緑"), RESULT:1
PRINTFORM  ({BASE:ARG:1,5}/{MAXBASE:ARG:1,5})
IF BASE:ARG:1 != 1000
	PRINTBUTTON "[−]", 2
ELSE
	SETCOLOR 色設定_設定_無効化
	PRINT [−]
	RESETCOLOR
ENDIF
IF BASE:ARG:1 != 3000
	PRINTBUTTON "[＋]", 3
ELSE
	SETCOLOR 色設定_設定_無効化
	PRINT [＋]
	RESETCOLOR
ENDIF
PRINTL
;素質の設定
@TALENT_CUSTOM(ARG,ARG:1)
VARSET LOCAL
FOR LOCAL,ARG:1 * 40,40 + ARG:1 * 40
	IF LOCAL % 10 == 0
		PRINTL
		SIF LOCAL:1 % 2
			PRINTL
		LOCAL:1 = 0
	ENDIF
	;陥落素質ほか
	;;[肉便器]を追加。[管理人]は選べない
	SIF (LOCAL >= 3 && LOCAL <= 5) || LOCAL == 9 || LOCAL == 34 || (LOCAL >= 72 && LOCAL <= 76) || LOCAL == 84 || LOCAL == 85 || (LOCAL >= 153 && LOCAL <= 155) || LOCAL == 38
		CONTINUE
	;TALENT.CSVに登録されていない
	SIF TALENTNAME:LOCAL == ""
		CONTINUE
	;オンオフ型の素質(TALENTNAMEと素質表示が一致)
	IF TALENTNAME:LOCAL == GET_TALENTNAME(LOCAL,1)
		IF !TALENT:ARG:LOCAL
			SETCOLOR 色設定_テキスト_無効
		ELSE
			SETCOLOR 0x60EEEE
		ENDIF
		LOCALS = [{LOCAL,3}] - %TALENTNAME:LOCAL%
	;童貞
	ELSEIF LOCAL == 1
		IF !TALENT:ARG:LOCAL == 0
			SETCOLOR 色設定_テキスト_無効
		ELSEIF (TALENT:ARG:2 == 1 || TALENT:ARG:2 == 0)
			SETCOLOR 色設定_テキスト_無効
		ELSE
			SETCOLOR 0x60EEEE
		ENDIF
		LOCALS = [{LOCAL,3}] - %TALENTNAME:LOCAL%
	;量的素質
	ELSE
		IF !TALENT:ARG:LOCAL
			SETCOLOR 色設定_テキスト_無効
		ELSE
			SETCOLOR 0x60EEEE
		ENDIF
		LOCALS =  [{LOCAL,3}] - %TALENTNAME:LOCAL%
		IF STRLENS(GET_TALENTNAME(LOCAL,TALENT:ARG:LOCAL))
			LOCALS:1 =  …【%GET_TALENTNAME(LOCAL,TALENT:ARG:LOCAL)%】
		ELSE
			LOCALS:1 = …
			SETCOLOR 色設定_テキスト_無効
		ENDIF
		LOCALS += LOCALS:1
	ENDIF
	PRINTFORM %LOCALS,55,LEFT%
	LOCAL:1 ++
	IF LOCAL:1 % 2 == 0
		SETCOLOR 色設定_テキスト_無効
		PRINTL
	ENDIF
	RESETCOLOR
NEXT
PRINTL

IF ARG:1 != 0
	PRINTBUTTON "[998] - Previous page                                  ",998
ELSE
	SETCOLOR 色設定_テキスト_無効
	PRINTFORM %"[---] - Previous page",55,LEFT%
	RESETCOLOR
ENDIF
IF ARG:1 != 3
	PRINTBUTTON "[999] - Next page",999
ELSE
	SETCOLOR 色設定_テキスト_無効
	PRINTFORM %"[---] - Next page",35,LEFT%
	RESETCOLOR
ENDIF
PRINTL

@ABL_CUSTOM(ARG)
LOCAL:1 = 0
FOR LOCAL,0,50
	SIF !STRLENS(ABLNAME:LOCAL)
		CONTINUE
	;同性愛関係
	IF !(HAS_VAGINA(ARG)) && (LOCAL == 17 || LOCAL == 32)
		CONTINUE
	ELSEIF HAS_VAGINA(ARG) && (LOCAL == 18 || LOCAL == 33)
		CONTINUE
	ENDIF
	;中毒も無し
	SIF LOCAL >= 30
		CONTINUE
	PRINTFORM %ABLNAME:LOCAL,12%:{ABL:ARG:LOCAL,5,LEFT} 
	IF ABL:ARG:LOCAL != 0
		PRINTBUTTON "[−]", LOCAL * 2
	ELSE
		SETCOLOR 色設定_テキスト_無効
		PRINT [−]
		RESETCOLOR
	ENDIF
	IF ABL:ARG:LOCAL != 2
		PRINTBUTTON "[＋]", LOCAL * 2 + 1
	ELSE
		SETCOLOR 色設定_テキスト_無効
		PRINT [＋]
		RESETCOLOR
	ENDIF
	LOCAL:1 ++
	SIF LOCAL:1 % 2 == 0
		PRINTL 
NEXT
PRINTL
@EXP_CUSTOM(ARG)
VARSET LOCAL
FOR LOCAL,0,100
	SIF !STRLENS(EXPNAME:LOCAL)
		CONTINUE
	;同性愛関係
	IF !(HAS_VAGINA(ARG)) && LOCAL == 51
		CONTINUE
	ELSEIF HAS_VAGINA(ARG) && LOCAL == 52
		CONTINUE
	ENDIF
	SIF (60 <= LOCAL && LOCAL <= 65)
		CONTINUE
		
	LOCALS = {EXP:ARG:LOCAL}

	;because word gets mangled too
	IF LOCAL == 44
	PRINTFORM 　[{LOCAL,2}] - Exposure
	LOCAL:98 = 31 - STRLENS(EXPNAME:44) - STRLENS(LOCALS)
	ELSEIF LOCAL == 92 
	PRINTFORM 　[{LOCAL,2}] - Cheated With
	LOCAL:98 = 27 - STRLENS(EXPNAME:92) - STRLENS(LOCALS)
	ELSEIF LOCAL == 93
	PRINTFORM 　[{LOCAL,2}] - Previous Cheating
	LOCAL:98 = 27 - STRLENS(EXPNAME:93) - STRLENS(LOCALS)
	ELSE
	PRINTFORM 　[{LOCAL,2}] - %REPLACE(EXPNAME:LOCAL, " Exp", "")%
	LOCAL:98 = 31 - STRLENS(EXPNAME:LOCAL) - STRLENS(LOCALS)
	ENDIF
		IF LOCAL:98 > 0
			SETCOLOR 0x606060
			PRINTFORM %"." * LOCAL:98%
			RESETCOLOR
		ENDIF
	PRINTFORM {EXP:ARG:LOCAL}
	LOCAL:1 += 1
	SIF LOCAL:1 % 3 == 0
		PRINTL 
NEXT
PRINTL
PRINTL
PRINTBUTTON "　[998] - Reset",998
PRINTL
PRINTBUTTON "　[999] - Set all at random",999
PRINTL

@CLOTHES_CUSTOM(ARG)
;あなた以外なら変更しない
SIF NO:ARG
	RETURN 0
IF HAS_VAGINA(ARG)
	CFLAG:ARG:服装パターン = 2
ELSE
	CFLAG:ARG:服装パターン = 1
ENDIF
PRINTFORM Currently %CALLNAME:MASTER% is dressed as a 
IF CFLAG:ARG:服装パターン == 2
	PRINT woman
ELSEIF CFLAG:ARG:服装パターン == 1
	PRINT man
ENDIF
PRINTL .
PRINTL Would you like to change it?
PRINTL [0] - Leave it as is [1] - Dress as a man [2] - Dress as a woman
INPUT
SIF RESULT == 1 || RESULT == 2
	CFLAG:ARG:服装パターン = RESULT

IF CFLAG:ARG:服装パターン == 2
	PRINTFORML Would you like to dress as a \@(CFLAG:ARG:服装パターン == 1) ? butler # maid\@?
	PRINTFORML [0] - Leave it as is [1] - Become a \@(CFLAG:ARG:服装パターン == 1) ? butler # maid\@
	INPUT
	SIF RESULT == 1
		CFLAG:ARG:服装パターン += RESULT * 2
ENDIF
RETURN 0

;全員処女モード
@VIRGIN_CUSTOM
	#DIM LOOP_CHR
	PRINTL Should be other residents in the mansion be virgins?
	PRINTL [0] Of course they're all pure innocent virgins
	PRINTL [1] Don't change anything, used goods are fine too
	PRINTL [2] I want to set them individually
	PRINTL [3] They lived long enough so they all should have some experience
	PRINTL [4] Random!
	PRINTL [5] Women are nothing but sluts for the cock
	$INPUT_LOOP
	INPUT
	SELECTCASE RESULT
	CASE 0
		PRINTW Everyone in the mansion set to be virgins, their experience will be changed accordingly.
		FOR LOOP_CHR,1,CHARANUM
			IF HAS_VAGINA(LOOP_CHR)
				TALENT:LOOP_CHR:処女 = 1
				EXP:LOOP_CHR:Ｃ経験 = 0
				EXP:LOOP_CHR:Ｂ経験 = 0
				EXP:LOOP_CHR:Ｖ経験 = 0
				EXP:LOOP_CHR:Ａ経験 = 0
				ABL:LOOP_CHR:Ｖ感覚 = 0
				ABL:LOOP_CHR:Ａ感覚 = 0
				EXP:LOOP_CHR:Ｖ性交経験 = 0
				EXP:LOOP_CHR:Ｖ拡張経験 = 0
				EXP:LOOP_CHR:Ａ性交経験 = 0
				EXP:LOOP_CHR:Ａ拡張経験 = 0
				EXP:LOOP_CHR:手淫経験 = 0
				EXP:LOOP_CHR:口淫経験 = 0
				EXP:LOOP_CHR:パイズリ経験 = 0
				EXP:LOOP_CHR:キス経験 = 0
				EXP:LOOP_CHR:奉仕快楽経験 = 0
				EXP:LOOP_CHR:愛情経験 = 0
				EXP:LOOP_CHR:苦痛快楽経験 = 0
				EXP:LOOP_CHR:嗜虐快楽経験 = 0
				EXP:LOOP_CHR:露出快楽経験 = 0
				EXP:LOOP_CHR:緊縛経験 = 0
				EXP:LOOP_CHR:絶頂経験 = 0
				EXP:LOOP_CHR:射精経験 = 0
				EXP:LOOP_CHR:噴乳経験 = 0
				EXP:LOOP_CHR:精液経験 = 0
				EXP:LOOP_CHR:精飲経験 = 0
				
				IF EXP:LOCAL:自慰経験
					EXP:LOCAL:絶頂経験 = MAX(CSVEXP(LOCAL,10), RAND:10)
				SIF EXP:LOCAL:絶頂経験 > (EXP:LOCAL:自慰経験)
					EXP:LOCAL:絶頂経験 = (EXP:LOCAL:自慰経験)
				ENDIF
			ENDIF
		NEXT
	CASE 1
		PRINTW Changed nothing.
	CASE 2
		CALL VIRGIN_SET2
	CASE 3
		FOR LOCAL,1,CHARANUM
		SIF HAS_PENIS(LOCAL)
			TALENT:LOCAL:童貞 = 1
		IF HAS_VAGINA(LOCAL)
			TALENT:LOCAL:処女 = 0
			SIF TALENT:LOCAL:性別嗜好 == 1
				TALENT:LOCAL:性別嗜好 = 0
			EXP:LOCAL:キス経験 = MAX(CSVEXP(LOCAL,27), RAND:30)
			EXP:LOCAL:手淫経験 = MAX(CSVEXP(LOCAL,24), RAND:30)
			EXP:LOCAL:口淫経験 = MAX(CSVEXP(LOCAL,25), RAND:30)
			EXP:LOCAL:パイズリ経験 = MAX(CSVEXP(LOCAL,26), RAND:30)
			EXP:LOCAL:Ｖ経験 = MAX(CSVEXP(LOCAL,1), RAND:50+1)
			ABL:LOCAL:Ｖ感覚 = MAX(CSVABL(LOCAL,1), 2)
			ABL:LOCAL:Ａ感覚 = MAX(CSVABL(LOCAL,2), 2)
			ABL:LOCAL:腰 = MAX(CSVABL(LOCAL,53), 2)
			EXP:LOCAL:Ｖ性交経験 = MAX(CSVEXP(LOCAL,20), RAND:50+1)
			;checking for a logical fallacy
			SIF EXP:LOCAL:Ｖ性交経験 > EXP:LOCAL:Ｖ経験
				EXP:LOCAL:Ｖ性交経験 = EXP:LOCAL:Ｖ経験
			EXP:LOCAL:精液経験 = MAX(CSVEXP(LOCAL,14), RAND:20+1)
			IF EXP:LOCAL:口淫経験 && EXP:LOCAL:精液経験
				EXP:LOCAL:精飲経験 = MAX(CSVEXP(LOCAL,15), RAND:20)
			SIF EXP:LOCAL:精飲経験 > EXP:LOCAL:精液経験
				EXP:LOCAL:精飲経験 /= 2
			SIF EXP:LOCAL:精飲経験 > EXP:LOCAL:口淫経験
				EXP:LOCAL:精飲経験 = RAND(EXP:LOCAL:精飲経験/5, EXP:LOCAL:精飲経験/2)
			ENDIF
			EXP:LOCAL:Ａ経験 = MAX(CSVEXP(LOCAL,2), RAND:30)
			EXP:LOCAL:Ａ性交経験 = MAX(CSVEXP(LOCAL,21), RAND:30)
			SIF EXP:LOCAL:Ａ性交経験 > EXP:LOCAL:Ａ経験
				EXP:LOCAL:Ａ性交経験 = EXP:LOCAL:Ａ経験
			
			CALL 締り具合変動, LOCAL, RAND(80, 200), 0
			CALL 締り具合変動, LOCAL, RAND(80, 200), 1
			
			;SIF EXP:LOCAL:精液経験 < (EXP:LOCAL:膣射経験 + EXP:LOCAL:精飲経験 + EXP:LOCAL:肛射経験)
			;	EXP:LOCAL:精液経験 = (EXP:LOCAL:膣射経験 + EXP:LOCAL:精飲経験 + EXP:LOCAL:肛射経験)
				
			IF EXP:LOCAL:Ｖ性交経験 || EXP:LOCAL:Ａ性交経験 || EXP:LOCAL:自慰経験
				EXP:LOCAL:絶頂経験 = MAX(CSVEXP(LOCAL,10), RAND:10)
			SIF EXP:LOCAL:絶頂経験 > (EXP:LOCAL:Ｖ性交経験 + EXP:LOCAL:Ａ性交経験 + EXP:LOCAL:自慰経験)
				EXP:LOCAL:絶頂経験 = (EXP:LOCAL:Ｖ性交経験 + EXP:LOCAL:Ａ性交経験 + EXP:LOCAL:自慰経験)
			ENDIF
		ENDIF
		NEXT
		PRINTW Everyone will have some experience.
	CASE 4
	FOR LOCAL,1,CHARANUM
	SIF HAS_PENIS(LOCAL)
		TALENT:LOCAL:童貞 = RAND:2
	IF HAS_VAGINA(LOCAL)
		TALENT:LOCAL:処女 = RAND:2
		IF TALENT:LOCAL:処女 == 1
			EXP:LOCAL:Ｃ経験 = 0
			EXP:LOCAL:Ｂ経験 = 0
			EXP:LOCAL:Ｖ経験 = 0
			EXP:LOCAL:Ａ経験 = 0
			ABL:LOCAL:Ｖ感覚 = 0
			ABL:LOCAL:Ａ感覚 = 0
			EXP:LOCAL:Ｖ性交経験 = 0
			EXP:LOCAL:Ａ性交経験 = 0
			EXP:LOCAL:手淫経験 = 0
			EXP:LOCAL:口淫経験 = 0
			EXP:LOCAL:パイズリ経験 = 0
			EXP:LOCAL:キス経験 = 0
			EXP:LOCAL:奉仕快楽経験 = 0
			EXP:LOCAL:愛情経験 = 0
			EXP:LOCAL:苦痛快楽経験 = 0
			EXP:LOCAL:嗜虐快楽経験 = 0
			EXP:LOCAL:露出快楽経験 = 0
			EXP:LOCAL:緊縛経験 = 0
			EXP:LOCAL:絶頂経験 = 0
			EXP:LOCAL:射精経験 = 0
			EXP:LOCAL:噴乳経験 = 0
			EXP:LOCAL:精液経験 = 0
			EXP:LOCAL:精飲経験 = 0
		ELSEIF TALENT:LOCAL:処女 == 0
			SIF RAND:2
				EXP:LOCAL:キス経験 = MAX(CSVEXP(LOCAL,27), RAND:30)
			EXP:LOCAL:手淫経験 = MAX(CSVEXP(LOCAL,24), RAND:30)
			EXP:LOCAL:口淫経験 = MAX(CSVEXP(LOCAL,25), RAND:30)
			EXP:LOCAL:パイズリ経験 = MAX(CSVEXP(LOCAL,26), RAND:30)
			EXP:LOCAL:Ｖ経験 = MAX(CSVEXP(LOCAL,1), RAND:30+1)
			ABL:LOCAL:Ｖ感覚 = MAX(CSVABL(LOCAL,1), 1)
			ABL:LOCAL:腰 = MAX(CSVABL(LOCAL,53), 1)
			EXP:LOCAL:Ｖ性交経験 = MAX(CSVEXP(LOCAL,20), RAND:20+1)
			SIF EXP:LOCAL:Ｖ性交経験 > EXP:LOCAL:Ｖ経験
				EXP:LOCAL:Ｖ性交経験 = EXP:LOCAL:Ｖ経験
			EXP:LOCAL:精液経験 = MAX(CSVEXP(LOCAL,14), RAND:20+1)
			
			IF EXP:LOCAL:口淫経験 && EXP:LOCAL:精液経験
				EXP:LOCAL:精飲経験 = MAX(CSVEXP(LOCAL,15), RAND:20)
			SIF EXP:LOCAL:精飲経験 > EXP:LOCAL:精液経験
				EXP:LOCAL:精飲経験 /= 2
			SIF EXP:LOCAL:精飲経験 > EXP:LOCAL:口淫経験
				EXP:LOCAL:精飲経験 = RAND(EXP:LOCAL:精飲経験/5, EXP:LOCAL:精飲経験/2)
			ENDIF
			
			IF RAND:2
				ABL:LOCAL:Ａ感覚 = MAX(CSVABL(LOCAL,2), 1)
				EXP:LOCAL:Ａ経験 = MAX(CSVEXP(LOCAL,2), RAND:20)
				EXP:LOCAL:Ａ性交経験 = MAX(CSVEXP(LOCAL,21), RAND:20)
				SIF EXP:LOCAL:Ａ性交経験 > EXP:LOCAL:Ａ経験
					EXP:LOCAL:Ａ性交経験 = EXP:LOCAL:Ａ経験
				CALL 締り具合変動, LOCAL, RAND(80, 200), 1
			ENDIF
			CALL 締り具合変動, LOCAL, RAND(80, 200), 0
			
			;SIF EXP:LOCAL:精液経験 < (EXP:LOCAL:膣射経験 + EXP:LOCAL:精飲経験 + EXP:LOCAL:肛射経験)
			;	EXP:LOCAL:精液経験 = (EXP:LOCAL:膣射経験 + EXP:LOCAL:精飲経験 + EXP:LOCAL:肛射経験)
			
			IF EXP:LOCAL:Ｖ性交経験 || EXP:LOCAL:Ａ性交経験 || EXP:LOCAL:自慰経験
				EXP:LOCAL:絶頂経験 = MAX(CSVEXP(LOCAL,10), RAND:10)
			SIF EXP:LOCAL:絶頂経験 > (EXP:LOCAL:Ｖ性交経験 + EXP:LOCAL:Ａ性交経験 + EXP:LOCAL:自慰経験)
				EXP:LOCAL:絶頂経験 = (EXP:LOCAL:Ｖ性交経験 + EXP:LOCAL:Ａ性交経験 + EXP:LOCAL:自慰経験)
			ENDIF
		ENDIF
	ENDIF
	NEXT
		PRINTW Everyone will have a random experience.
	CASE 5
	FOR LOCAL,1,CHARANUM
		TALENT:LOCAL:処女 = 0
		SIF HAS_PENIS(LOCAL)
			TALENT:LOCAL:童貞 = 1
		SIF TALENT:LOCAL:性別嗜好 == 1
			TALENT:LOCAL:性別嗜好 = 0
		EXP:LOCAL:キス経験 = MAX(CSVEXP(LOCAL,27), RAND:90)
		EXP:LOCAL:手淫経験 = MAX(CSVEXP(LOCAL,24), RAND:120+50)
		EXP:LOCAL:口淫経験 = MAX(CSVEXP(LOCAL,25), RAND:120+50)
		EXP:LOCAL:パイズリ経験 = MAX(CSVEXP(LOCAL,26), RAND:80+50)
		EXP:LOCAL:Ｖ経験 = MAX(CSVEXP(LOCAL,1), RAND:50+50)
		ABL:LOCAL:Ｖ感覚 = MAX(CSVABL(LOCAL,1), 3)
		ABL:LOCAL:腰 = MAX(CSVABL(LOCAL,53), 3)
		ABL:LOCAL:欲望 = 2
		EXP:LOCAL:Ｖ性交経験 = MAX(CSVEXP(LOCAL,20), RAND:50+50)
		SIF EXP:LOCAL:Ｖ性交経験 > EXP:LOCAL:Ｖ経験
			EXP:LOCAL:Ｖ性交経験 = EXP:LOCAL:Ｖ経験
		EXP:LOCAL:精液経験 = MAX(CSVEXP(LOCAL,14), RAND:50+50)
		IF EXP:LOCAL:口淫経験 && EXP:LOCAL:精液経験
			EXP:LOCAL:精飲経験 = MAX(CSVEXP(LOCAL,15), RAND:50+50)
			SIF EXP:LOCAL:精飲経験 > EXP:LOCAL:精液経験
				EXP:LOCAL:精飲経験 /= 2
			SIF EXP:LOCAL:精飲経験 > EXP:LOCAL:口淫経験
				EXP:LOCAL:精飲経験 = RAND(EXP:LOCAL:精飲経験/5, EXP:LOCAL:精飲経験/2)
		ENDIF
		ABL:LOCAL:Ａ感覚 = MAX(CSVABL(LOCAL,2), 3)
		EXP:LOCAL:Ａ経験 = MAX(CSVEXP(LOCAL,2), RAND:30+30)
		EXP:LOCAL:Ａ性交経験 = MAX(CSVEXP(LOCAL,21), RAND:30+30)
		SIF EXP:LOCAL:Ａ性交経験 > EXP:LOCAL:Ａ経験
			EXP:LOCAL:Ａ性交経験 = EXP:LOCAL:Ａ経験
		CALL 締り具合変動, LOCAL, RAND(80, 200), 1
		CALL 締り具合変動, LOCAL, RAND(80, 200), 0
		;SIF EXP:LOCAL:精液経験 < (EXP:LOCAL:膣射経験 + EXP:LOCAL:精飲経験 + EXP:LOCAL:肛射経験)
		;	EXP:LOCAL:精液経験 = (EXP:LOCAL:膣射経験 + EXP:LOCAL:精飲経験 + EXP:LOCAL:肛射経験)
			
		IF EXP:LOCAL:Ｖ性交経験 || EXP:LOCAL:Ａ性交経験 || EXP:LOCAL:自慰経験
			EXP:LOCAL:絶頂経験 = MAX(CSVEXP(LOCAL,10), RAND:200)
		SIF EXP:LOCAL:絶頂経験 > (EXP:LOCAL:Ｖ性交経験 + EXP:LOCAL:Ａ性交経験 + EXP:LOCAL:自慰経験)
			EXP:LOCAL:絶頂経験 = (EXP:LOCAL:Ｖ性交経験 + EXP:LOCAL:Ａ性交経験 + EXP:LOCAL:自慰経験)
		ENDIF
		TALENT:LOCAL:公衆便所 = 1
	NEXT
		PRINTW Everyone has been set to be a slut.
	CASEELSE
		GOTO INPUT_LOOP
	ENDSELECT
RETURN 0

@VIRGIN_SET2
FOR LOCAL,1,CHARANUM
	SIF TALENT:LOCAL:処女
		SETCOLOR C_PINK
	SIF TALENT:LOCAL:公衆便所
		SETCOLOR C_P_BLUE
	PRINTFORML [{LOCAL,2}] %CALLNAME:LOCAL%
	RESETCOLOR
NEXT
PRINTL 　
DRAWLINE
PRINTL [999] Finished
$LOOP
INPUT
IF RESULT >= 1 && RESULT <= CHARANUM
	IF TALENT:RESULT:公衆便所
		TALENT:RESULT:処女 = 1
		SIF HAS_PENIS(RESULT)
			TALENT:RESULT:童貞 = 0
		EXP:RESULT:Ｃ経験 = 0
		EXP:RESULT:Ｂ経験 = 0
		EXP:RESULT:Ｖ経験 = 0
		EXP:RESULT:Ａ経験 = 0
		ABL:RESULT:Ｖ感覚 = 0
		ABL:RESULT:Ａ感覚 = 0
		ABL:RESULT:腰 = 0
		ABL:RESULT:欲望 = 0
		TALENT:RESULT:性別嗜好 = CSVTALENT(RESULT,81)
		EXP:RESULT:手淫経験 = 0
		EXP:RESULT:口淫経験 = 0
		EXP:RESULT:パイズリ経験 = 0
		EXP:RESULT:キス経験 = 0
		EXP:RESULT:Ｖ性交経験 = 0
		EXP:RESULT:Ａ性交経験 = 0
		EXP:RESULT:Ｖ拡張経験 = 0
		EXP:RESULT:精液経験 = 0
		EXP:RESULT:緊縛経験 = 0
		EXP:RESULT:絶頂経験 = 0
		EXP:RESULT:射精経験 = 0
		EXP:RESULT:噴乳経験 = 0
		EXP:RESULT:精飲経験 = 0
		BASE:RESULT:Ｖ緩さ = CSVBASE(RESULT,20)
		BASE:RESULT:Ａ緩さ = CSVBASE(RESULT,21)
		
		IF EXP:RESULT:自慰経験
			EXP:RESULT:絶頂経験 = MAX(CSVEXP(RESULT,10), RAND:10)
		SIF EXP:RESULT:絶頂経験 > (EXP:RESULT:自慰経験)
			EXP:RESULT:絶頂経験 = (EXP:RESULT:自慰経験)
		ENDIF
		PRINTW Made into virgin.	
	ELSEIF TALENT:RESULT:処女
		TALENT:RESULT:処女 = 0
		SIF HAS_PENIS(RESULT) && RAND:2
			TALENT:RESULT:童貞 = 1
		SIF RAND:2
			EXP:RESULT:キス経験 = MAX(CSVEXP(RESULT,27), RAND:30)
		EXP:RESULT:手淫経験 = MAX(CSVEXP(RESULT,24), RAND:30)
		EXP:RESULT:口淫経験 = MAX(CSVEXP(RESULT,25), RAND:30)
		EXP:RESULT:パイズリ経験 = MAX(CSVEXP(RESULT,26), RAND:30)
		EXP:RESULT:Ｖ経験 = MAX(CSVEXP(RESULT,1), RAND:30+1)
		ABL:RESULT:Ｖ感覚 = MAX(CSVABL(RESULT,1), 1)
		ABL:RESULT:腰 = MAX(CSVABL(RESULT,53), 1)
		EXP:RESULT:Ｖ性交経験 = MAX(CSVEXP(RESULT,20), RAND:20+1)
		SIF EXP:RESULT:Ｖ性交経験 > EXP:RESULT:Ｖ経験
			EXP:RESULT:Ｖ性交経験 = EXP:RESULT:Ｖ経験
		EXP:RESULT:精液経験 = MAX(CSVEXP(RESULT,14), RAND:20+1)
		IF EXP:RESULT:口淫経験 && EXP:RESULT:精液経験
			EXP:RESULT:精飲経験 = MAX(CSVEXP(RESULT,15), RAND:20)
			SIF EXP:RESULT:精飲経験 > EXP:RESULT:精液経験
				EXP:RESULT:精飲経験 /= 2
			SIF EXP:RESULT:精飲経験 > EXP:RESULT:口淫経験
				EXP:RESULT:精飲経験 = RAND(EXP:RESULT:精飲経験/5, EXP:RESULT:精飲経験/2)
		ENDIF
		IF RAND:2
			ABL:RESULT:Ａ感覚 = MAX(CSVABL(RESULT,2), 1)
			EXP:RESULT:Ａ経験 = MAX(CSVEXP(RESULT,2), RAND:20)
			EXP:RESULT:Ａ性交経験 = MAX(CSVEXP(RESULT,21), RAND:20)
			SIF EXP:RESULT:Ａ性交経験 > EXP:RESULT:Ａ経験
				EXP:RESULT:Ａ性交経験 = EXP:RESULT:Ａ経験
			CALL 締り具合変動, RESULT, RAND(80, 200), 1
		ENDIF
		CALL 締り具合変動, RESULT, RAND(80, 200), 0
		;SIF EXP:RESULT:精液経験 < (EXP:RESULT:膣射経験 + EXP:RESULT:精飲経験 + EXP:RESULT:肛射経験)
		;	EXP:RESULT:精液経験 = (EXP:RESULT:膣射経験 + EXP:RESULT:精飲経験 + EXP:RESULT:肛射経験)
			
		IF EXP:RESULT:Ｖ性交経験 || EXP:RESULT:Ａ性交経験 || EXP:RESULT:自慰経験
			EXP:RESULT:絶頂経験 = MAX(CSVEXP(RESULT,10), RAND:10)
		SIF EXP:RESULT:絶頂経験 > (EXP:RESULT:Ｖ性交経験 + EXP:RESULT:Ａ性交経験 + EXP:RESULT:自慰経験)
			EXP:RESULT:絶頂経験 = (EXP:RESULT:Ｖ性交経験 + EXP:RESULT:Ａ性交経験 + EXP:RESULT:自慰経験)
		ENDIF
		PRINTW Made into non-virgin.
	ELSE
		TALENT:RESULT:処女 = 0
		SIF HAS_PENIS(RESULT)
			TALENT:RESULT:童貞 = 1
		SIF TALENT:RESULT:性別嗜好 == 1
			TALENT:RESULT:性別嗜好 = 0
		EXP:RESULT:キス経験 = MAX(CSVEXP(RESULT,27), RAND:90)
		EXP:RESULT:手淫経験 = MAX(CSVEXP(RESULT,24), RAND:120+50)
		EXP:RESULT:口淫経験 = MAX(CSVEXP(RESULT,25), RAND:120+50)
		EXP:RESULT:パイズリ経験 = MAX(CSVEXP(RESULT,26), RAND:80+50)
		EXP:RESULT:Ｖ経験 = MAX(CSVEXP(RESULT,1), RAND:50+50)
		ABL:RESULT:Ｖ感覚 = MAX(CSVABL(RESULT,1), 3)
		ABL:RESULT:腰 = MAX(CSVABL(RESULT,53), 3)
		ABL:RESULT:欲望 = 2
		EXP:RESULT:Ｖ性交経験 = MAX(CSVEXP(RESULT,20), RAND:50+50)
		SIF EXP:RESULT:Ｖ性交経験 > EXP:RESULT:Ｖ経験
			EXP:RESULT:Ｖ性交経験 = EXP:RESULT:Ｖ経験
		EXP:RESULT:精液経験 = MAX(CSVEXP(RESULT,14), RAND:50+50)
		IF EXP:RESULT:口淫経験 && EXP:RESULT:精液経験
			EXP:RESULT:精飲経験 = MAX(CSVEXP(RESULT,15), RAND:50+50)
			SIF EXP:RESULT:精飲経験 > EXP:RESULT:精液経験
				EXP:RESULT:精飲経験 /= 2
			SIF EXP:RESULT:精飲経験 > EXP:RESULT:口淫経験
				EXP:RESULT:精飲経験 = RAND(EXP:RESULT:精飲経験/5, EXP:RESULT:精飲経験/2)
		ENDIF
		ABL:RESULT:Ａ感覚 = MAX(CSVABL(RESULT,2), 3)
		EXP:RESULT:Ａ経験 = MAX(CSVEXP(RESULT,2), RAND:30+30)
		EXP:RESULT:Ａ性交経験 = MAX(CSVEXP(RESULT,21), RAND:30+30)
		SIF EXP:RESULT:Ａ性交経験 > EXP:RESULT:Ａ経験
			EXP:RESULT:Ａ性交経験 = EXP:RESULT:Ａ経験
		CALL 締り具合変動, RESULT, RAND(80, 200), 1
		CALL 締り具合変動, RESULT, RAND(80, 200), 0
		;SIF EXP:RESULT:精液経験 < (EXP:RESULT:膣射経験 + EXP:RESULT:精飲経験 + EXP:RESULT:肛射経験)
		;	EXP:RESULT:精液経験 = (EXP:RESULT:膣射経験 + EXP:RESULT:精飲経験 + EXP:RESULT:肛射経験)
			
		IF EXP:RESULT:Ｖ性交経験 || EXP:RESULT:Ａ性交経験 || EXP:RESULT:自慰経験
			EXP:RESULT:絶頂経験 = MAX(CSVEXP(RESULT,10), RAND:200)
		SIF EXP:RESULT:絶頂経験 > (EXP:RESULT:Ｖ性交経験 + EXP:RESULT:Ａ性交経験 + EXP:RESULT:自慰経験)
			EXP:RESULT:絶頂経験 = (EXP:RESULT:Ｖ性交経験 + EXP:RESULT:Ａ性交経験 + EXP:RESULT:自慰経験)
		ENDIF
		
		TALENT:RESULT:公衆便所 = 1
		PRINTW Made into slut.
	ENDIF
	RESTART
ELSEIF RESULT == 999
	PRINTW Configuration has been completed.
ELSE
	GOTO LOOP
ENDIF
