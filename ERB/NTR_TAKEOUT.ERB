;-------------------------------------------------------------------------------
;NTRお持ち帰り関係
;　訪問者による住人お持ち帰り関係の処理
;　あなたお持ち帰りは別枠
;-------------------------------------------------------------------------------
;	お持ち帰り中処理
;-------------------------------------------------------------------------------
;-------------------------------------------------------------------------------
;お持ち帰り最中
@VISITER_TAKINGOUT(奴隷)
	#DIM 奴隷
	#DIM LOOP_I
	#DIM 移動ルートループ
	#DIM 移動目撃フラグ
	;現在位置から紅魔館玄関への移動経路を算出
	CALLF FARMOVE(奴隷,CFLAG:奴隷:現在位置,場所_正門)
	移動目撃フラグ = 0
	FOR 移動ルートループ,0,移動ルートMAX
		IF (0 == 移動ルート:奴隷:移動ルートループ)
			BREAK
		ENDIF
		IF NTR_CHK_VISIBLE( 移動ルート:奴隷:移動ルートループ )
			移動目撃フラグ = 1
		ENDIF
	NEXT
	;移動経路算出に使った移動ルートを消去しておく
	CALLF RESET_ROUTE(奴隷,1)
	;お持ち帰り時初期化処理
	CALL INIT_TAKINGOUT(奴隷)
	IF 移動目撃フラグ
		PRINTFORMW %NTR_NAME(0)%に誘われ、%CALLNAME:奴隷%はどこかへとついていった
		IF TALENT:奴隷:公衆便所 && TALENT:奴隷:処女 
			;処女公衆便所競売
			CALL NTR_VIRGIN_AUCTION(奴隷)
		ELSE
			;口上呼び出しの前に口上の特殊な客情報生成があれば実行
			TRYCALLLIST
				FUNC NTR_KOJO_K{CFLAG:奴隷:297}_MAKE_CLIENT(奴隷)
				FUNC NTR_KOJO_K_MAKE_CLIENT(奴隷)
			ENDFUNC
			;口上呼び出し、現在の口上は訪問者宅描写が混じっているので訪問者宅を前提とする
			IF NTR_CHK_VISIBLE(場所_訪問者宅)
				TRYCALLLIST
					FUNC NTR_KOJO_K{CFLAG:奴隷:297}_10_0(奴隷)
					FUNC NTR_KOJO_K_10_0(奴隷)
				ENDFUNC
			ENDIF
		ENDIF
	ENDIF
	CALL NTR_RESET_VISITOR_ACTION(奴隷)
RETURN 0

;お持ち帰り時初期化処理
;VISITER_TAKINGOUTとGoOut_SeeYou_900の共通処理
@INIT_TAKINGOUT(奴隷)
	#DIM 奴隷
	#DIM LOOP_I

	;客情報クリア
	CFLAG:奴隷:持帰分岐 = 0
	CFLAG:奴隷:客人数 = -1
	CFLAG:奴隷:客人数加算フラグ = 0
	FOR LOOP_I,0,10
		TB:奴隷:LOOP_I:TB_客番号 = -1
		TB:奴隷:LOOP_I:TB_客種別 = -1
	NEXT
	;同行解除
	CFLAG:奴隷:同行 = 0
	;うふふ解除
	IF CFLAG:奴隷:うふふ>0 && CFLAG:MASTER:うふふ>0
		CFLAG:奴隷:うふふ = 0
		CFLAG:MASTER:うふふ = 0
	ENDIF
	;汚れ発覚による逃走なし
	CFLAG:奴隷:汚れ発覚 = 汚れ発覚_なし
	;現在位置を強制的に開錠
	FLAG:(300 + FLAG:訪問者の現在位置) = 0
	;訪問者宅へ移動
	FLAG:訪問者の現在位置 = 場所_訪問者宅
	CFLAG:奴隷:現在位置 = 場所_訪問者宅
	FLAG:訪問者同行フラグ = 0
	FLAG:訪問者との汚れ判定に使用 = 0
	FLAG:訪問者滞在時間カウンタ = 0
	CFLAG:奴隷:NTRカウンターセクハラ = NTR_CNT_なし
	EXP:奴隷:前回浮気人数 = 0
	CFLAG:奴隷:前回売春フラグ = 0
	CFLAG:奴隷:持帰時処女 = TALENT:奴隷:処女
	CFLAG:奴隷:持帰Ｖ射精回数 = 0
	CFLAG:奴隷:持帰Ａ射精回数 = 0
RETURN 0

;-------------------------------------------------------------------------------
;処女奴隷競売イベント
@NTR_VIRGIN_AUCTION(奴隷)
	#DIM 奴隷
	#DIM 金額
	PRINTFORMW :
	PRINTFORMW :
	PRINTFORMW %CALLNAME:奴隷%は売春宿へ連れていかれ、そこで何人もの男達の前に立たされた。
	PRINTFORMW %NTR_NAME(0)%は、なんと%CALLNAME:奴隷%の処女を競売にかけると告げた。
	TRYCALLLIST
		FUNC NTR_KOJO_K{CFLAG:奴隷:297}_VA_0(奴隷)
		FUNC NTR_KOJO_K_VA_0(奴隷)
	ENDFUNC
	IF TALENT:奴隷:処女 == 1
		金額 = NTR_COST_UNLOCK(奴隷, 0) * 40
	ELSE
		金額 = NTR_COST_UNLOCK(奴隷, 0) * 20
	ENDIF
	PRINTFORMW 「{金額}！」
	金額 += NTR_COST_UNLOCK(奴隷, 0) * 2
	PRINTFORMW 「{金額}！」
	金額 += NTR_COST_UNLOCK(奴隷, 0) * 3
	PRINTFORMW 「{金額}だ！」
	PRINTFORMW :
	PRINTFORMW :
	金額 += NTR_COST_UNLOCK(奴隷, 0) * RAND:4 + 1000
	PRINTFORMW 最終的に、%CALLNAME:奴隷%の処女は${金額}で落札された。
	IF TALENT:奴隷:恋慕
		PRINTFORM %MSG_LOVER(奴隷)%である%CALLNAME:MASTER%の知らないところで、
	ELSE
	ENDIF
	PRINTFORMW %CALLNAME:奴隷%の処女は、${金額}で名も知らぬ客に買い上げられてしまった。
	TRYCALLLIST
		FUNC NTR_KOJO_K{CFLAG:奴隷:297}_VA_1(奴隷)
		FUNC NTR_KOJO_K_VA_1(奴隷)
	ENDFUNC
RETURN 0

;-------------------------------------------------------------------------------
;客情報生成
@MAKE_CLIENT(奴隷, 客の人数)
	#DIM 奴隷
	#DIM 客の人数
	#DIM 客番号
	#DIM 客の種類
	#DIM LOOP_I
	;客の人数保存
	CFLAG:奴隷:客人数 = 客の人数
	IF TALENT:奴隷:公衆便所
		客の種類 = 1000
	ELSE
		客の種類 = 10
	ENDIF
	客番号 = RAND(客の種類)
	;重複しないように設定する
	FOR LOOP_I,0,客の人数
		TB:奴隷:LOOP_I:TB_客番号 = 客番号
		; 種別は1〜6 将来はキャラ口上の特殊ケースにも対応させたい
		TB:奴隷:LOOP_I:TB_客種別 = RAND(6)
		;次の客番号生成
		客番号 += RAND(50)+1
		IF 客番号 >= 客の種類
			客番号 -= 客の種類
		ENDIF
	NEXT
RETURN 0

;-------------------------------------------------------------------------------
;	お持ち帰り後処理
;-------------------------------------------------------------------------------
;-------------------------------------------------------------------------------
;お持ち帰り後
@VISITER_TAKEOUT(奴隷)
	#DIM 奴隷
	#DIM 調教者
	#DIM DYNAMIC 客の人数
	#DIM DYNAMIC プレイ時間
	#DIM DYNAMIC 浮気快楽強度
	#DIM ムード上限値 = 50
	#DIM プレイ内容
	#DIM LOOP_I
	#DIM 処女喪失中保存		; 処女喪失中フラグの退避用

	;一応処女喪失フラグリセット（複数回発生しちゃうので
	CFLAG:奴隷:処女喪失中 = 0
	処女喪失中保存 = CFLAG:奴隷:処女喪失中
	;予約時間毎に何かする
	;各種素質により毎ターン上乗せ。
	FLAG:訪問者のムード += 1 * TALENT:奴隷:淫壺
	FLAG:訪問者のムード += 1 * TALENT:奴隷:尻穴狂い
	FLAG:訪問者のムード += 1 * TALENT:奴隷:淫乳
	FLAG:訪問者のムード += 1 * TALENT:奴隷:浮気な唇
	FLAG:訪問者のムード += 1 * TALENT:奴隷:浮気な蜜壷
	FLAG:訪問者のムード += 1 * TALENT:奴隷:浮気な尻穴
	FLAG:訪問者のムード += 1 * TALENT:奴隷:浮気癖
	FLAG:訪問者のムード += 1 * TALENT:奴隷:淫乱
	FLAG:訪問者のムード += 1 * TALENT:奴隷:NTR
	FLAG:訪問者のムード += 1 * TALENT:奴隷:公衆便所
	FLAG:訪問者のムード += 1 * TALENT:奴隷:浮気公認
	;予約時間になるまでは同じ行動
	IF FLAG:訪問者との行為の終了時刻 > DATETIME()
		RETURN 0
	ENDIF
	;体力500未満の場合休息が与えられる
	IF BASE:奴隷:体力 < 500
		IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
			PRINTFORML %"ぐったりとして動かなくなった"+CALLNAME:奴隷+"に、僅かな休憩が与えられた。"%
			;休息したらプレイ内容のリセット、ムード半減
			プレイ内容 = 0
			FLAG:訪問者のムード /= 2
		ENDIF
		;休憩は２時間程度。おそらく体力はマイナス行くので強制的に700まで回復。
		FLAG:訪問者との行為の終了時刻 = DATETIME() + 119
		BASE:奴隷:体力 = LIMIT(BASE:奴隷:体力+119*2*(480-120*TALENT:奴隷:回復速度),700,MAXBASE:奴隷:体力)
		BASE:奴隷:気力 = LIMIT(BASE:奴隷:気力+119*2*(480-120*TALENT:奴隷:回復速度),700,MAXBASE:奴隷:気力)
		;貸切でなければ客も入れ替え、ムードも減らす
		IF TALENT:奴隷:公衆便所 && CFLAG:奴隷:持帰分岐 == 0
			CFLAG:奴隷:客人数 = -1
			プレイ内容 = 0
			FLAG:訪問者のムード = 5
			CFLAG:奴隷:持帰Ｖ射精回数 = 0
			CFLAG:奴隷:持帰Ａ射精回数 = 0
		ENDIF
		RETURN 0
	ENDIF
	IF CFLAG:奴隷:客人数 != -1
		;客がいる場合継続
		客の人数 = CFLAG:奴隷:客人数
	ELSEIF FLAG:再教育フラグ == 1
		;再教育モード
		客の人数 = 0
		FLAG:訪問者のムード = 50
	ELSEIF TALENT:奴隷:公衆便所 && CFLAG:奴隷:持帰分岐 > 0
		;プレイの指定がある場合、口上の都合で相手は１人。多分貸切にしてるのだろう。
		客の人数 = 1
	ELSEIF TALENT:奴隷:公衆便所 && TALENT:奴隷:処女
		;処女オークションの時は相手は一人。
		客の人数 = 1
	ELSEIF TALENT:奴隷:公衆便所
		;プレイの指定が無い場合は客を1〜3人取る。淫乱/娼婦なら人数が増えやすくなる。
		客の人数 = LIMIT(RAND:(4+TALENT:奴隷:淫乱),1,3)
	ELSEIF TALENT:奴隷:親愛
		;屈服しない親愛持ちを輪姦する
		客の人数 = LIMIT(RAND:(4+TALENT:奴隷:淫乱),2,3)
	ELSEIF TALENT:奴隷:淫乱 && CFLAG:奴隷:客人数 == -1
		;淫乱なら5%の確率で他の男に抱かせる
		IF (RAND:20 == 0)
			IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
				PRINTFORMW %NTR_NAME(0)+"は"+CALLNAME:奴隷+"を他の男に抱かせるつもりのようだ……"%
				IF TALENT:奴隷:恋慕
					PRINTFORML %CALLNAME:奴隷%は%MSG_LOVER(奴隷)%がいるにもかかわらず、その要求を受け入れた。
				ELSE
					PRINTFORML %CALLNAME:奴隷%はその要求を受け入れた。
				ENDIF
				TRYCALLLIST
					FUNC NTR_KOJO_K{CFLAG:奴隷:297}_19_1(奴隷)
					FUNC NTR_KOJO_K_19_1(奴隷)
				ENDFUNC
				PRINTL
			ENDIF
			客の人数 = 1
			;CFLAG:奴隷:客人数 = -1
		ENDIF
	ELSEIF CFLAG:奴隷:屈服度 > 5000 && TALENT:奴隷:浮気公認 >= 4 && CFLAG:奴隷:客人数 == -1
		;屈服度>5000かつ浮気公認が4LV以上あれば、5%の確率で他の男に抱かせる
		IF (RAND:20 == 0)
			IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
				PRINTFORML %NTR_NAME(0)+"は"+CALLNAME:奴隷+"を他の男に抱かせるつもりのようだ……"%
				IF TALENT:奴隷:恋慕
					PRINTFORML %CALLNAME:奴隷%は%MSG_LOVER(奴隷)%がいるにもかかわらず、その要求を受け入れた。
				ELSE
					PRINTFORML %CALLNAME:奴隷%はその要求を受け入れた。
				ENDIF
				TRYCALLLIST
					FUNC NTR_KOJO_K{CFLAG:奴隷:297}_19_2(奴隷)
					FUNC NTR_KOJO_K_19_2(奴隷)
				ENDFUNC
				PRINTL
			ENDIF
			客の人数 = 1
			;CFLAG:奴隷:客人数 = -1
		ENDIF
	ENDIF
	;処女アナル厨の時は4Pはなし
	IF IS_NTR_KEEP_VIRGIN() && TALENT:奴隷:処女
		IF (客の人数 > 2)
			客の人数 = 2
		ENDIF
	ENDIF
	;客がいれば調教者は客(999)、いなければ訪問者(998)
	IF (客の人数 > 0)
		調教者 = 人物_客
		IF -1 == CFLAG:奴隷:客人数
			;客人数未定義であれば客情報生成
			CALL MAKE_CLIENT(奴隷, 客の人数)
			;客入れ替え時会話からスタートするように。
			FLAG:訪問者のムード = 5
			CFLAG:奴隷:客人数加算フラグ = 1
		ELSE
			;客人数定義済みであればそちらを使用
			客の人数 = CFLAG:奴隷:客人数
		ENDIF
	ELSE
		調教者 = 人物_訪問者
	ENDIF
	;ムードが悪い時は帰る
	IF FLAG:訪問者のムード < 0
		CFLAG:奴隷:現在位置 = 場所_正門
		IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
			TRYCALL 客口上(奴隷, 0, TB:奴隷:0:TB_客種別)
			PRINTFORMW %CALLNAME:奴隷%がどこかから帰ってきたようだ
			;ムードが悪くて帰ってきた時は汚れ具合とか違うだろうから別関数とする。
			TRYCALLLIST
				FUNC NTR_KOJO_K{CFLAG:奴隷:297}_0_1(奴隷)
				FUNC NTR_KOJO_K_0_1(奴隷)
			ENDFUNC
		ENDIF
		RETURN 0
	ENDIF
	IF FLAG:訪問者のムード < 10
		;会話(好感度上昇のみ)
		プレイ内容 = 1
		プレイ時間 = (RAND:5 + 5)
		CALL VISITOR_TAKEOUT_10_01(奴隷,調教者)
	ELSEIF FLAG:訪問者のムード < 20
		;キス
		プレイ内容 = 1
		プレイ内容 = 2
		プレイ時間 = (RAND:5 + 5)
		CALL VISITOR_TAKEOUT_10_02(奴隷,調教者)
		;口上(地の文)呼び出し
		IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
			CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
		ENDIF
	ELSEIF FLAG:訪問者のムード < 30
		;色々前戯 シックスナインイメージ
		プレイ内容 = 3
		プレイ時間 = (RAND:5 + 5)
		CALL VISITOR_TAKEOUT_10_03(奴隷,調教者)
		;口上(地の文)呼び出し
		IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
			CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
		ENDIF
	ELSE
		;プレイ時間が確定(30〜59分)
		プレイ時間 = (RAND:30 + 30)
		;プレイ時間により屈服度が増加
		CALL NTR_ADD_SURRENDER(奴隷, MAX(プレイ時間/10,0))
		IF FLAG:訪問者のムード > 44 && プレイ内容 > 3
			;ムード45以上かつ、１回はプレイ内容４（射精無しセックス）してること
			プレイ内容 = 5
			;持ち帰り時処女フラグかつ最初の射精時は処女喪失中扱いとする
			;(処女喪失中フラグは毎回クリアされてしまうため)
			IF CFLAG:奴隷:持帰時処女 && CFLAG:奴隷:持帰Ｖ射精回数 == 0
				処女喪失中保存 = 1
				CFLAG:奴隷:処女喪失中 = CFLAG:奴隷:持帰時処女
			ENDIF
		ELSE
			プレイ内容 = 4
		ENDIF
		SELECTCASE 客の人数
			CASE 1
				;公衆便所でない時の処女保存処理
				IF IS_NTR_KEEP_VIRGIN() && TALENT:奴隷:処女 && !TALENT:奴隷:公衆便所
					TFLAG:輪姦内容 = 輪姦_1A
				ELSE
					;一人であれば必ずＶ（持帰分岐時の都合でＶ以外とは合わない）、１人で３部位相手にするのでプレイ時間は1/3。
					TFLAG:輪姦内容 = 輪姦_1V
				ENDIF
				;口上(地の文)呼び出し
				IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
					CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
				ENDIF
				CALL NTR_Play_B_0(奴隷,調教者,プレイ内容-4,プレイ時間*1/3)
				CALL NTR_Play_C_0(奴隷,調教者,プレイ内容-4,プレイ時間*1/3)
				SELECTCASE CFLAG:奴隷:持帰分岐
					CASE 1,100 ;Ｓプレイ(咲夜、レミリア)、撮影(大妖精)、騎乗位
						CALL NTR_Play_V_2(奴隷,調教者,プレイ内容-4,プレイ時間*1/3)
					CASE 2 ;犬プレイ(咲夜)、Ｍプレイ(レミリア)、後背位
						CALL NTR_Play_V_1(奴隷,調教者,プレイ内容-4,プレイ時間*1/3)
					CASE 3 ;種付けプレイ(咲夜）、正常位
						CALL NTR_Play_V_0(奴隷,調教者,プレイ内容-4,プレイ時間*1/3)
					CASE 4 ;結婚式プレイ(咲夜）、対面座位
						CALL NTR_Play_V_3(奴隷,調教者,プレイ内容-4,プレイ時間*1/3)
					CASEELSE ;該当なしならとりあえず正常位
						IF TFLAG:輪姦内容 == 輪姦_1A
							CALL NTR_Play_A_0(奴隷,調教者,プレイ内容-4,プレイ時間*1/3)
						ELSE
							CALL NTR_Play_V_0(奴隷,調教者,プレイ内容-4,プレイ時間*1/3)
						ENDIF
				ENDSELECT
			CASE 2
				;二人いるときは２穴使用。２人で４部位相手にするのでプレイ時間は2/4で。
				IF IS_NTR_KEEP_VIRGIN() && TALENT:奴隷:処女 && !TALENT:奴隷:公衆便所
					;公衆便所でない時の処女保存処理
					TFLAG:輪姦内容 = 輪姦_2MA ;ＭＡ、イメージ的にＡ後背位
					;口上(地の文)呼び出し
					IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
						CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
					ENDIF
					CALL NTR_Play_B_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_C_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_M_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_A_1(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
				ELSEIF EXP:奴隷:Ｖ拡張経験 > 49 && RAND:5 == 0
					TFLAG:輪姦内容 = 輪姦_2VV ;Ｖ２本挿入、イメージ的に対面座位+背面座位
					;口上(地の文)呼び出し
					IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
						CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
					ENDIF
					;Ｖ拡張経験が250以下なら二本差しでＶ拡張経験が付く
					IF EXP:奴隷:Ｖ拡張経験 < 250
						SIF GETBIT(FLAG:ＮＴＲパッチ設定,32) || CFLAG:MASTER:現在位置 == CFLAG:奴隷:現在位置
							PRINTFORML まだ拡がりきっていない%CALLNAME:奴隷%の膣は、二本差しされたペニスによって無理矢理に拡張されている…
						EXP:奴隷:Ｖ拡張経験 += 1
					ELSEIF EXP:奴隷:Ｖ拡張経験 > 249
						SIF GETBIT(FLAG:ＮＴＲパッチ設定,32) || CFLAG:MASTER:現在位置 == CFLAG:奴隷:現在位置
							PRINTFORML 度重なる拡張によって%CALLNAME:奴隷%の膣は、二本差しされたペニスもすんなりと飲み込んでいる…
					ENDIF
					CALL NTR_Play_B_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_C_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_V_3(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_V_4(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
				ELSEIF EXP:奴隷:Ａ拡張経験 > 49 && RAND:4 == 0
					TFLAG:輪姦内容 = 輪姦_2AA ;Ａ２本挿入、イメージ的に対面座位+背面座位
					;口上(地の文)呼び出し
					IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
						CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
					ENDIF
					;Ａ拡張経験が250以下なら二本差しでＡ拡張経験が付く
					IF EXP:奴隷:Ａ拡張経験 < 250
						SIF GETBIT(FLAG:ＮＴＲパッチ設定,32) || CFLAG:MASTER:現在位置 == CFLAG:奴隷:現在位置
							PRINTFORML まだ拡がりきっていない%CALLNAME:奴隷%のアヌスは、二本差しされたペニスによって無理矢理に拡張されている…
						EXP:奴隷:Ａ拡張経験 += 1
					ELSEIF EXP:奴隷:Ｖ拡張経験 > 249
						SIF GETBIT(FLAG:ＮＴＲパッチ設定,32) || CFLAG:MASTER:現在位置 == CFLAG:奴隷:現在位置
							PRINTFORML 度重なる拡張によって%CALLNAME:奴隷%のアヌスは、二本差しされたペニスもすんなりと飲み込んでいる…
					ENDIF
					CALL NTR_Play_B_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_C_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_A_3(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_A_4(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
				ELSEIF RAND:3 == 0
					TFLAG:輪姦内容 = 輪姦_2VA ;ＶＡ挿入、イメージ的にＶ対面座位+Ａ背面座位
					;口上(地の文)呼び出し
					IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
						CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
					ENDIF
					CALL NTR_Play_B_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_C_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_V_3(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_A_4(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
				ELSEIF RAND:2 == 0
					TFLAG:輪姦内容 = 輪姦_2MV ;ＭＶ、イメージ的にＶ後背位
					;口上(地の文)呼び出し
					IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
						CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
					ENDIF
					CALL NTR_Play_B_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_C_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_M_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_V_1(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
				ELSE
					TFLAG:輪姦内容 = 輪姦_2MA ;ＭＡ、イメージ的にＡ後背位
					;口上(地の文)呼び出し
					IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
						CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
					ENDIF
					CALL NTR_Play_B_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_C_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_M_0(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
					CALL NTR_Play_A_1(奴隷,調教者,プレイ内容-4,プレイ時間*2/4)
				ENDIF
			CASE 3
				;３人で５部位相手にするのでプレイ時間は3/5で。
				TFLAG:輪姦内容 = 輪姦_3MAV ; イメージ的にＶ騎乗位、Ａ後背位……かな。
				;口上(地の文)呼び出し
				IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
					CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
				ENDIF
				CALL NTR_Play_B_0(奴隷,調教者,プレイ内容-4,プレイ時間*3/5)
				CALL NTR_Play_C_0(奴隷,調教者,プレイ内容-4,プレイ時間*3/5)
				CALL NTR_Play_M_0(奴隷,調教者,プレイ内容-4,プレイ時間*3/5)
				CALL NTR_Play_A_1(奴隷,調教者,プレイ内容-4,プレイ時間*3/5)
				CALL NTR_Play_V_2(奴隷,調教者,プレイ内容-4,プレイ時間*3/5)
			CASEELSE
				;客がいない時は訪問者の相手。一人でVorA相手にするのでプレイ時間は1/4で。
				IF IS_NTR_KEEP_VIRGIN() && TALENT:奴隷:処女
					TFLAG:輪姦内容 = 輪姦_1A
				ELSEIF RAND:3
					TFLAG:輪姦内容 = 輪姦_1V
				ELSE
					TFLAG:輪姦内容 = 輪姦_1A
				ENDIF
				;口上(地の文)呼び出し
				IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
					CALLFORM NTR_MESSAGE_10_{プレイ内容}(奴隷, 調教者, TFLAG:輪姦内容)
				ENDIF
				CALL NTR_Play_B_0(奴隷,調教者,プレイ内容-4,プレイ時間/4)
				CALL NTR_Play_C_0(奴隷,調教者,プレイ内容-4,プレイ時間/4)
				IF TFLAG:輪姦内容 == 輪姦_1V
					CALLFORM NTR_Play_V_{RAND:4}(奴隷,調教者,プレイ内容-4,プレイ時間/4)
				ELSE
					CALLFORM NTR_Play_A_{RAND:4}(奴隷,調教者,プレイ内容-4,プレイ時間/4)
				ENDIF
				CALL NTR_Play_M_0(奴隷,調教者,プレイ内容-4,プレイ時間/4)
		ENDSELECT
		;公衆便所で客とのプレイは売春としてカウント(訪問者は金を払ってない設定)
		IF 調教者 == 人物_客 && TALENT:奴隷:公衆便所 > 0
			; 今回が初めて
			IF EXP:奴隷:売春経験  == 0
				CFLAG:奴隷:前回売春フラグ |= 前回売春_初売春
			ENDIF
			EXP:奴隷:売春経験 ++
		ENDIF
		IF 0 != CFLAG:奴隷:客人数加算フラグ
			FOR LOOP_I, 0, 客の人数
				EXP:奴隷:浮気人数 = NTR_FickleCount(奴隷,調教者,LOOP_I)
			NEXT
			CFLAG:奴隷:客人数加算フラグ = 0
		ENDIF
	ENDIF
	;プレイ時間を反映
	FLAG:訪問者との行為の終了時刻 = DATETIME() + プレイ時間
	;絶頂判定
	CALL NTR_SOURCE_CHECK(奴隷,調教者)
	CALL ORGASM_ADD(奴隷,調教者)
	;ORGASM_ADDを呼んだ直後なら R で本来の快楽強度が取得できる
	;訪問者なら最大LV12まで、客の場合6までとする。
	浮気快楽強度 = (調教者 == 人物_訪問者) ? RESULT # RESULT / 2
	;口上呼び出し
	IF NTR_CHK_VISIBLE(FLAG:訪問者の現在位置)
		IF 客の人数
			TRYCALL 客口上(奴隷, プレイ内容, TB:奴隷:0:TB_客種別)
		ENDIF
		TRYCALLLIST
			FUNC NTR_KOJO_K{CFLAG:奴隷:297}_10_{プレイ内容}(奴隷, 調教者, 客の人数)
			FUNC 客汎用地の文(奴隷, 調教者, プレイ内容)
		ENDFUNC
	ENDIF
	;処女喪失中フラグを一時退避していた場合復旧する
	IF 処女喪失中保存 == 1
		CFLAG:奴隷:処女喪失中 = 0
	ENDIF
	IF CFLAG:奴隷:処女喪失中
		;口上との兼ね合いでこの位置で確認
		;保存しておいた処女/再生処女フラグを取得
		TALENT:奴隷:処女 = CFLAG:奴隷:処女喪失中
		TRYCALL COM417_Lost_Virgin(奴隷, 調教者)
		;VisitorGotItAlready activated to prevent double message
		FLAG:9059 = 1
		;calling this message to show it right after to prevent the bug when player pops the cherry on the same or next turn
		CALL LOSEVIRGINTEXT(調教者)
		TALENT:奴隷:処女 = 0
		;処女を奪われるとムードがごっそり減る
		FLAG:訪問者のムード /= 2
	ENDIF
	;浮気快楽刻印の付与チェック
	CALL NTR_MARK_5(奴隷, 浮気快楽強度)
	IF RESULT:0
		;浮気快楽刻印が増えたら、一旦ムードを減らして帰りやすくしてあげる
		FLAG:訪問者のムード = -浮気快楽強度 * 2
	ENDIF
	;ムードの上下。最初のベース増加で0〜19程度増えるので特別な判定はしない。
	;NTR、公衆便所あたりがあれば減る事はない。快楽によりムード増加。上限以上あれば上限値に切り詰め。
	FLAG:訪問者のムード += MIN(ムード上限値,FLAG:訪問者のムード+(RAND:13 - 4)+浮気快楽強度)
	;行為における口上や射精関連のフラグリセット
	TFLAG:輪姦内容 = 輪姦_0
	;処女喪失口上が何度も出るのを防止
	CFLAG:奴隷:処女喪失中 = 0
RETURN 0

;-------------------------------------------------------------------------------
;お持ち帰り中のプレイ：会話
;@return 1:成功 0:失敗
@VISITOR_TAKEOUT_10_01(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	BASE:奴隷:気力 -= 10
	CALL NTR_ADD_SURRENDER(奴隷, 1)
	SIF EXP:奴隷:NTR陥落経験 
		CALL NTR_ADD_SURRENDER(奴隷, 1)
	SIF TALENT:奴隷:親愛
		EXP:奴隷:緊縛経験 ++
	;好感度吸収
	CALL NTR_DRAIN_LOVE(奴隷, 5)
RETURN 0

;-------------------------------------------------------------------------------
;お持ち帰り中のプレイ：キス
;@return 1:成功 0:失敗
@VISITOR_TAKEOUT_10_02(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	CALL NTR_ADD_SURRENDER(奴隷, (2 + (EXP:奴隷:NTR陥落経験>0)) )
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な唇)
	BASE:奴隷:気力 -= 80
	SOURCE:奴隷:情愛 = 50
	SOURCE:奴隷:性行動 = 10
	SOURCE:奴隷:屈従 = 10
	SOURCE:奴隷:逸脱 = 10
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感 = 5 * !TALENT:奴隷:浮気な唇
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 5
	ELSE
		SOURCE:奴隷:反感 = 10 * !TALENT:奴隷:浮気な唇
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 10
	ENDIF
	EXP:奴隷:キス経験 ++
	SIF !TALENT:奴隷:親愛
		EXP:奴隷:浮気キス経験 ++
	SIF TALENT:奴隷:親愛
		EXP:奴隷:緊縛経験 ++
	;好感度吸収
	CALL NTR_DRAIN_LOVE(奴隷, 10)
RETURN 0

;-------------------------------------------------------------------------------
;お持ち帰り中のプレイ：愛撫（69）
;@param 奴隷       愛撫されるキャラ
;@param 調教者     愛撫するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@VISITOR_TAKEOUT_10_03(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	FLAG:訪問者との行為の終了時刻 = DATETIME() + 10
	CALL NTR_ADD_SURRENDER(奴隷, 3)
	SIF EXP:奴隷:NTR陥落経験 
		CALL NTR_ADD_SURRENDER(奴隷, 1)
	BASE:奴隷:体力 -= 20
	BASE:奴隷:気力 -= 160
	SOURCE:奴隷:快Ｃ = 100
	SOURCE:奴隷:情愛 = 100
	SOURCE:奴隷:性行動 = 450
	SOURCE:奴隷:達成 = 200
	SOURCE:奴隷:液体 = 80
	SOURCE:奴隷:露出 = 100
	SOURCE:奴隷:屈従 = 800
	SOURCE:奴隷:逸脱 = 600
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感 = 200
	ELSE
		SOURCE:奴隷:反感 = 600
	ENDIF
	IF IS_NTR_KEEP_VIRGIN() && TALENT:奴隷:処女
		SOURCE:奴隷:快Ａ += 20
	ENDIF
	IF !TALENT:奴隷:処女
		SOURCE:奴隷:快Ｖ += 60 + 60*(TALENT:奴隷:処女==0)
	ENDIF
	SOURCE:奴隷:露出 += 10 + 20*(TALENT:奴隷:処女>0)
	SOURCE:奴隷:逸脱 += 20 + 10*(TALENT:奴隷:処女>0)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:苦痛 += 5 +  5*(TALENT:奴隷:処女>0)
		SOURCE:奴隷:反感 += 10 + 50*(TALENT:奴隷:処女>0)
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 400
	ELSE
		SOURCE:奴隷:苦痛 += 15 +  5*(TALENT:奴隷:処女>0)
		SOURCE:奴隷:反感 += 20 + 10*(TALENT:奴隷:処女>0)
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 800
	ENDIF
	CALL STAIN_ADD_SEMEN_M(奴隷, 調教者)
	EXP:奴隷:口淫経験 ++
	EXP:奴隷:嗜虐快楽経験 += TALENT:奴隷:猫舌
	SIF !TALENT:奴隷:親愛
		EXP:奴隷:浮気口淫経験 ++
	SIF TALENT:奴隷:親愛
		EXP:奴隷:緊縛経験 ++
	;好感度吸収
	CALL NTR_DRAIN_LOVE(奴隷, 30)
RETURN 0

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：クリ愛撫
;@param 奴隷       愛撫されるキャラ
;@param 調教者     愛撫するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_C_0(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (1 * (EXP:奴隷:NTR陥落経験>0)) )
	;体力、気力の減少
	BASE:奴隷:体力 -= 5 * (プレイ時間/5)
	BASE:奴隷:気力 -= 50 * (プレイ時間/5)
	;調教ソースの増加。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:歓楽   += 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   += 100 * (プレイ時間/5)
	SOURCE:奴隷:欲情   += 150 * (プレイ時間/5)
	SOURCE:奴隷:露出   += 100 * (プレイ時間/5)
	SOURCE:奴隷:快Ｃ   += 100 * (プレイ時間/5)
	SOURCE:奴隷:受動   += (145+270*ABL:奴隷:従順) * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   += 185 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 10
	ELSE
		SOURCE:奴隷:反感   += 370 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 20
	ENDIF
	SIF TALENT:奴隷:親愛
		EXP:奴隷:緊縛経験 ++
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 10)
	ENDIF
	射精 = 0
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：胸愛撫
;@param 奴隷       愛撫されるキャラ
;@param 調教者     愛撫するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_B_0(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (1 * (EXP:奴隷:NTR陥落経験>0)) )
	;体力、気力の減少
	BASE:奴隷:体力 -= 5 * (プレイ時間/5)
	BASE:奴隷:気力 -= 50 * (プレイ時間/5)
	;調教ソースの増加。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ｂ   += 120 * (プレイ時間/5)
	SOURCE:奴隷:歓楽   += 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   += 150 * (プレイ時間/5)
	SOURCE:奴隷:欲情   += 170 * (プレイ時間/5)
	SOURCE:奴隷:露出   +=  70 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   += 175 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 10
	ELSE
		SOURCE:奴隷:反感   += 350 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 20
	ENDIF
	SIF TALENT:奴隷:親愛
		EXP:奴隷:緊縛経験 ++
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 10)
	ENDIF
	射精 = 0
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：フェラチオ
;@param 奴隷       フェラチオさせられキャラ
;@param 調教者     フェラチオさせるキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_M_0(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な唇がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な唇) 
	;体力、気力の減少
	BASE:奴隷:体力 -= 10 * (プレイ時間/5)
	BASE:奴隷:気力 -= 100 * (プレイ時間/5)
	;調教ソースの増加。浮気な唇により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:情愛   +=  100 * (TALENT:奴隷:浮気な唇 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:性行動 +=  300 * (TALENT:奴隷:浮気な唇 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:達成   +=  150 * (TALENT:奴隷:浮気な唇 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:屈従   +=  700 * (TALENT:奴隷:浮気な唇 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=   66 * (TALENT:奴隷:浮気な唇 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   +=  100 * (TALENT:奴隷:浮気な唇 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 200
	ELSE
		SOURCE:奴隷:反感   +=  200 * (TALENT:奴隷:浮気な唇 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 400
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が増える
	SIF CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 200
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_M(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_M(奴隷,調教者,(射精 && (ABL:奴隷:舌 > RAND:5)))
	NEXT
	SIF TALENT:奴隷:親愛
		EXP:奴隷:緊縛経験 ++
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：Ａ正常位
;@param 奴隷       挿入されるキャラ
;@param 調教者     挿入するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_A_0(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	#DIM iLoop
	FOR iLoop,0,プレイ時間,5
		IF (調教者 == 人物_客)
			CALL 締り具合変動, 奴隷, RAND(3,5), 1
		ELSE
			CALL 締り具合変動, 奴隷, 3, 1
		ENDIF
	NEXT
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な尻穴がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な尻穴)
	;体力、気力の減少
	BASE:奴隷:体力 -= 80 * (プレイ時間/5)
	BASE:奴隷:気力 -= 120 * (プレイ時間/5)
	;ちょいとチートだが潤滑は追加
	PALAM:奴隷:潤滑 = PALAMLV:4
	;調教ソースの増加。浮気な尻穴により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ａ   +=  400 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   +=  100 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:苦痛   +=  800 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:露出   +=   60 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:逸脱   +=  200 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=   60 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   +=  250 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 250
	ELSE
		SOURCE:奴隷:反感   +=  500 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 500
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が一気に増える
	SIF TALENT:奴隷:貞操 > 0 && CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 1500
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_A(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_A(奴隷,調教者,(射精 && (ABL:奴隷:アナル > RAND:5)))
	NEXT
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：Ａ後背位
;@param 奴隷       挿入されるキャラ
;@param 調教者     挿入するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_A_1(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	#DIM iLoop
	FOR iLoop,0,プレイ時間,5
		IF (調教者 == 人物_客)
			CALL 締り具合変動, 奴隷, RAND(3,5), 1
		ELSE
			CALL 締り具合変動, 奴隷, 3, 1
		ENDIF
	NEXT
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な尻穴がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な尻穴)
	;体力、気力の減少
	BASE:奴隷:体力 -= 80 * (プレイ時間/5)
	BASE:奴隷:気力 -= 120 * (プレイ時間/5)
	;ちょいとチートだが潤滑は追加
	PALAM:奴隷:潤滑 = PALAMLV:4
	;調教ソースの増加。浮気な尻穴により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ａ   +=  400 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   +=  100 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:苦痛   +=  900 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:露出   +=   80 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:逸脱   +=  200 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=   60 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   +=  250 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 250
	ELSE
		SOURCE:奴隷:反感   +=  500 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 500
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が一気に増える
	SIF TALENT:奴隷:貞操 > 0 && CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 1500
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_A(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_A(奴隷,調教者,(射精 && (ABL:奴隷:アナル > RAND:5)))
	NEXT
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：Ａ騎乗位
;@param 奴隷       挿入されるキャラ
;@param 調教者     挿入するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_A_2(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	#DIM iLoop
	FOR iLoop,0,プレイ時間,5
		IF (調教者 == 人物_客)
			CALL 締り具合変動, 奴隷, RAND(3,5), 1
		ELSE
			CALL 締り具合変動, 奴隷, 3, 1
		ENDIF
	NEXT
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な尻穴がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な尻穴)
	;体力、気力の減少
	BASE:奴隷:体力 -= 80 * (プレイ時間/5)
	BASE:奴隷:気力 -= 200 * (プレイ時間/5)
	;ちょいとチートだが潤滑は追加
	PALAM:奴隷:潤滑 = PALAMLV:4
	;調教ソースの増加。浮気な尻穴により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ａ   +=  500 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   +=  250 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:性行動 +=  250 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:達成   +=  250 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:苦痛   +=  800 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:露出   +=  120 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:逸脱   +=  700 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=   60 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   +=  450 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 450
	ELSE
		SOURCE:奴隷:反感   +=  900 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 900
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が一気に増える
	SIF TALENT:奴隷:貞操 > 0 && CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 1500
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_A(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_A(奴隷,調教者,(射精 && (ABL:奴隷:アナル > RAND:5)))
	NEXT
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：Ａ対面座位
;@param 奴隷       挿入されるキャラ
;@param 調教者     挿入するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_A_3(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	#DIM iLoop
	FOR iLoop,0,プレイ時間,5
		IF (調教者 == 人物_客)
			CALL 締り具合変動, 奴隷, RAND(3,5), 1
		ELSE
			CALL 締り具合変動, 奴隷, 3, 1
		ENDIF
	NEXT
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な尻穴がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な尻穴)
	;体力、気力の減少
	BASE:奴隷:体力 -= 70 * (プレイ時間/5)
	BASE:奴隷:気力 -= 150 * (プレイ時間/5)
	;ちょいとチートだが潤滑は追加
	PALAM:奴隷:潤滑 = PALAMLV:4
	;調教ソースの増加。浮気な尻穴により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ｃ   +=  250 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:快Ａ   +=  350 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   +=  250 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:性行動 +=  250 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:達成   +=  250 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:苦痛   +=  800 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:露出   +=  120 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:逸脱   +=  700 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=   60 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   +=  450 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 450
	ELSE
		SOURCE:奴隷:反感   +=  900 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 900
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が一気に増える
	SIF TALENT:奴隷:貞操 > 0 && CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 1500
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_A(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_A(奴隷,調教者,(射精 && (ABL:奴隷:アナル > RAND:5)))
	NEXT
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：Ａ背面座位
;@param 奴隷       挿入されるキャラ
;@param 調教者     挿入するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_A_4(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	#DIM iLoop
	FOR iLoop,0,プレイ時間,5
		IF (調教者 == 人物_客)
			CALL 締り具合変動, 奴隷, RAND(3,5), 1
		ELSE
			CALL 締り具合変動, 奴隷, 3, 1
		ENDIF
	NEXT
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な尻穴がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な尻穴)
	;体力、気力の減少
	BASE:奴隷:体力 -= 80 * (プレイ時間/5)
	BASE:奴隷:気力 -= 200 * (プレイ時間/5)
	;ちょいとチートだが潤滑は追加
	PALAM:奴隷:潤滑 = PALAMLV:4
	;調教ソースの増加。浮気な尻穴により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ａ   += 500 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   += 250 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:性行動 += 250 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:達成   += 250 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:苦痛   += 800 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:露出   += 120 * (TALENT:奴隷:浮気な尻穴 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:逸脱   += 700 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=  60 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   += 450 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 450
	ELSE
		SOURCE:奴隷:反感   += 900 * (TALENT:奴隷:浮気な尻穴 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 900
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が一気に増える
	SIF TALENT:奴隷:貞操 > 0 && CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 1500
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_A(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_A(奴隷,調教者,(射精 && (ABL:奴隷:アナル > RAND:5)))
	NEXT
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：Ｖ正常位
;@param 奴隷       挿入されるキャラ
;@param 調教者     挿入するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_V_0(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	#DIM iLoop
	FOR iLoop,0,プレイ時間,5
		IF (調教者 == 人物_客)
			CALL 締り具合変動, 奴隷, RAND(3,5), 0
		ELSE
			CALL 締り具合変動, 奴隷, 3, 0
		ENDIF
	NEXT
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な蜜壷がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な蜜壷)
	;体力、気力の減少
	BASE:奴隷:体力 -= 50 * (プレイ時間/5)
	BASE:奴隷:気力 -= 100 * (プレイ時間/5)
	;ちょいとチートだが潤滑は追加
	PALAM:奴隷:潤滑 = PALAMLV:4
	;調教ソースの増加。浮気な蜜壺により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ｖ   +=  400 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   +=  150 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:苦痛   +=  500 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:露出   +=   50 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=   60 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   +=  150 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 150
	ELSE
		SOURCE:奴隷:反感   +=  300 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 300
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が増える
	SIF TALENT:奴隷:貞操 > 0 && CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 1000
	;処女であれば苦痛が増加
	IF TALENT:奴隷:処女 == 1
		SOURCE:奴隷:苦痛 += 2000
		IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
			SOURCE:奴隷:反感 += 1500
		ELSE
			SOURCE:奴隷:反感 += 3000
		ENDIF
	ELSEIF TALENT:奴隷:処女 == 2
		SOURCE:奴隷:苦痛 += 500
		IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
			SOURCE:奴隷:反感 += 500
		ELSE
			SOURCE:奴隷:反感 += 1000
		ENDIF
	ENDIF
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_V(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_V(奴隷,調教者,(射精 && (ABL:奴隷:膣 > RAND:5)))
	NEXT
	;ABL:奴隷:Ｖ感覚
	;ABL:奴隷:膣
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：Ｖ後背位
;@param 奴隷       挿入されるキャラ
;@param 調教者     挿入するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_V_1(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	#DIM iLoop
	FOR iLoop,0,プレイ時間,5
		IF (調教者 == 人物_客)
			CALL 締り具合変動, 奴隷, RAND(3,5), 0
		ELSE
			CALL 締り具合変動, 奴隷, 3, 0
		ENDIF
	NEXT
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な蜜壷がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な蜜壷)
	;体力、気力の減少
	BASE:奴隷:体力 -= 50 * (プレイ時間/5)
	BASE:奴隷:気力 -= 100 * (プレイ時間/5)
	;ちょいとチートだが潤滑は追加
	PALAM:奴隷:潤滑 = PALAMLV:4
	;調教ソースの増加。浮気な蜜壺により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ｖ   +=  400 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   +=  150 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:苦痛   +=  400 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:露出   +=   70 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=   60 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   +=  150 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 150
	ELSE
		SOURCE:奴隷:反感   +=  300 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 300
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が増える
	SIF TALENT:奴隷:貞操 > 0 && CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 1000
	;処女であれば苦痛が増加
	IF TALENT:奴隷:処女 == 1
		SOURCE:奴隷:苦痛 += 2000
		IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
			SOURCE:奴隷:反感 += 1500
		ELSE
			SOURCE:奴隷:反感 += 3000
		ENDIF
	ELSEIF TALENT:奴隷:処女 == 2
		SOURCE:奴隷:苦痛 += 500
		IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
			SOURCE:奴隷:反感 += 500
		ELSE
			SOURCE:奴隷:反感 += 1000
		ENDIF
	ENDIF
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_V(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_V(奴隷,調教者,(射精 && (ABL:奴隷:膣 > RAND:5)))
	NEXT
	;ABL:奴隷:Ｖ感覚
	;ABL:奴隷:膣
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：Ｖ騎乗位
;@param 奴隷       挿入されるキャラ
;@param 調教者     挿入するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_V_2(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	#DIM iLoop
	FOR iLoop,0,プレイ時間,5
		IF (調教者 == 人物_客)
			CALL 締り具合変動, 奴隷, RAND(3,5), 0
		ELSE
			CALL 締り具合変動, 奴隷, 3, 0
		ENDIF
	NEXT
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な蜜壷がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な蜜壷)
	;体力、気力の減少
	BASE:奴隷:体力 -= 60 * (プレイ時間/5)
	BASE:奴隷:気力 -= 150 * (プレイ時間/5)
	;ちょいとチートだが潤滑は追加
	PALAM:奴隷:潤滑 = PALAMLV:4
	;調教ソースの増加。浮気な蜜壺により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ｖ   +=  500 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   +=  250 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:性行動 +=  250 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:達成   +=  250 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:苦痛   +=  500 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:露出   +=  120 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:逸脱   +=  600 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=   60 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   +=  400 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 400
	ELSE
		SOURCE:奴隷:反感   +=  800 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 800
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が増える
	SIF TALENT:奴隷:貞操 > 0 && CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 1000
	;処女であれば苦痛が増加
	IF TALENT:奴隷:処女 == 1
		SOURCE:奴隷:苦痛 += 2000
		IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
			SOURCE:奴隷:反感 += 1500
		ELSE
			SOURCE:奴隷:反感 += 3000
		ENDIF
	ELSEIF TALENT:奴隷:処女 == 2
		SOURCE:奴隷:苦痛 += 500
		IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
			SOURCE:奴隷:反感 += 500
		ELSE
			SOURCE:奴隷:反感 += 1000
		ENDIF
	ENDIF
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_V(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_V(奴隷,調教者,(射精 && (ABL:奴隷:膣 > RAND:5)))
	NEXT
	;ABL:奴隷:Ｖ感覚
	;ABL:奴隷:膣
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：Ｖ対面座位
;@param 奴隷       挿入されるキャラ
;@param 調教者     挿入するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_V_3(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	#DIM iLoop
	FOR iLoop,0,プレイ時間,5
		IF (調教者 == 人物_客)
			CALL 締り具合変動, 奴隷, RAND(3,5), 0
		ELSE
			CALL 締り具合変動, 奴隷, 3, 0
		ENDIF
	NEXT
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な蜜壷がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な蜜壷)
	;体力、気力の減少
	BASE:奴隷:体力 -= 50 * (プレイ時間/5)
	BASE:奴隷:気力 -= 100 * (プレイ時間/5)
	;ちょいとチートだが潤滑は追加
	PALAM:奴隷:潤滑 = PALAMLV:4
	;調教ソースの増加。浮気な蜜壺により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ｖ   +=  350 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:快Ｃ   +=  250 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   +=  350 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:苦痛   +=  500 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:恭順   +=  300 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:逸脱   +=  500 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=   60 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   += 500 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 450
	ELSE
		SOURCE:奴隷:反感   += 1000 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 900
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が増える
	SIF TALENT:奴隷:貞操 > 0 && CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 1000
	;処女であれば苦痛が増加
	IF TALENT:奴隷:処女 == 1
		SOURCE:奴隷:苦痛 += 2000
		IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
			SOURCE:奴隷:反感 += 1500
		ELSE
			SOURCE:奴隷:反感 += 3000
		ENDIF
	ELSEIF TALENT:奴隷:処女 == 2
		SOURCE:奴隷:苦痛 += 500
		IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
			SOURCE:奴隷:反感 += 500
		ELSE
			SOURCE:奴隷:反感 += 1000
		ENDIF
	ENDIF
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_V(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_V(奴隷,調教者,(射精 && (ABL:奴隷:膣 > RAND:5)))
	NEXT
	;ABL:奴隷:Ｖ感覚
	;ABL:奴隷:膣
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;データがない相手とのプレイ：Ｖ背面座位
;@param 奴隷       挿入されるキャラ
;@param 調教者     挿入するキャラ（998で訪問者、999で客）
;@param 射精       1だと判定によっては射精が発生する
;@param プレイ時間 プレイにかけた時間
;@return 1:射精された 0:射精されてない
@NTR_Play_V_4(奴隷,調教者=人物_訪問者,射精=0,プレイ時間)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	#DIM プレイ時間
	#DIM iLoop
	FOR iLoop,0,プレイ時間,5
		IF (調教者 == 人物_客)
			CALL 締り具合変動, 奴隷, RAND(3,5), 0
		ELSE
			CALL 締り具合変動, 奴隷, 3, 0
		ENDIF
	NEXT
	TCVAR:奴隷:行為者 = 調教者
	;NTR陥落経験があれば屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, (2 * (EXP:奴隷:NTR陥落経験>0)) )
	;浮気な蜜壷がある場合は屈服度が増加
	CALL NTR_ADD_SURRENDER(奴隷, TALENT:奴隷:浮気な蜜壷)
	;体力、気力の減少
	BASE:奴隷:体力 -= 50 * (プレイ時間/5)
	BASE:奴隷:気力 -= 100 * (プレイ時間/5)
	;ちょいとチートだが潤滑は追加
	PALAM:奴隷:潤滑 = PALAMLV:4
	;調教ソースの増加。浮気な蜜壺により変化。通常プレイが５分毎なのでその分乗算する
	SOURCE:奴隷:快Ｃ   +=  250 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:快Ｖ   +=  350 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:快Ｂ   +=  250 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:情愛   +=  350 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:苦痛   +=  400 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:露出   +=  200 * (TALENT:奴隷:浮気な蜜壷 ? 150 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:逸脱   +=  600 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	SOURCE:奴隷:不潔   +=   60 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
	IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
		SOURCE:奴隷:反感   += 500 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 400
	ELSE
		SOURCE:奴隷:反感   += 1000 * (TALENT:奴隷:浮気な蜜壷 ?  66 # 100) / 100 * (プレイ時間/5)
		;抑圧 or 抵抗があると鬱屈が溜まる
		SIF TALENT:奴隷:自己愛 < 0 || TALENT:奴隷:抵抗
			SOURCE:奴隷:鬱屈 += 800
	ENDIF
	;貞操観念があり、訪問者への屈服度があなたの好感度より低い場合反感が増える
	SIF TALENT:奴隷:貞操 > 0 && CFLAG:奴隷:屈服度 < CFLAG:奴隷:好感度
		SOURCE:奴隷:反感 += 1000
	;処女であれば苦痛が増加
	IF TALENT:奴隷:処女 == 1
		SOURCE:奴隷:苦痛 += 2000
		IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
			SOURCE:奴隷:反感 += 1500
		ELSE
			SOURCE:奴隷:反感 += 3000
		ENDIF
	ELSEIF TALENT:奴隷:処女 == 2
		SOURCE:奴隷:苦痛 += 500
		IF TALENT:奴隷:公衆便所 && !TALENT:奴隷:親愛 
			SOURCE:奴隷:反感 += 500
		ELSE
			SOURCE:奴隷:反感 += 1000
		ENDIF
	ENDIF
	;口上との整合性を取るため、射精指定があれば最低１回の射精を確保
	CALL NTR_Insert_V(奴隷,調教者,射精)
	;以降はプレイ時間と技能の判定により射精回数を確保
	FOR LOCAL:0,10,プレイ時間,10
		CALL NTR_Insert_V(奴隷,調教者,(射精 && (ABL:奴隷:膣 > RAND:5)))
	NEXT
	;ABL:奴隷:Ｖ感覚
	;ABL:奴隷:膣
	;調教者が訪問者であれば、好感度吸収
	IF 調教者==人物_訪問者
		CALL NTR_DRAIN_LOVE(奴隷, 50)
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 射精

;-------------------------------------------------------------------------------
;口を使う場合の判定（共通）
@NTR_Insert_M(奴隷,調教者,射精)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	EXP:奴隷:口淫経験 ++
	IF TALENT:奴隷:親愛
		EXP:奴隷:緊縛経験 ++
		EXP:奴隷:被強姦経験 ++
		EXP:奴隷:被輪姦経験 ++
	ENDIF
	SIF !TALENT:奴隷:親愛
		EXP:奴隷:浮気口淫経験 ++
	IF 射精
		CALL EJACULATION_M(奴隷, 調教者)
	ENDIF
RETURN 0

;-------------------------------------------------------------------------------
;Ａを使う場合の判定（共通）
@NTR_Insert_A(奴隷,調教者,射精)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	TEQUIP:奴隷:Ａセックス = 調教者
	EXP:奴隷:Ａ経験 ++
	EXP:奴隷:Ａ性交経験 ++
	IF TALENT:奴隷:親愛
		EXP:奴隷:緊縛経験 ++
		EXP:奴隷:被強姦経験 ++
		EXP:奴隷:被輪姦経験 ++
	ENDIF
	IF 調教者==人物_訪問者 && 訪問者_Ｐ大きさ == 2
		EXP:奴隷:Ａ拡張経験 += 1
		SIF GETBIT(FLAG:ＮＴＲパッチ設定,32) || CFLAG:MASTER:現在位置 == CFLAG:奴隷:現在位置
			PRINTFORML %CALLNAME:奴隷%のアヌスは、%NTR_NAME(0)%の大きすぎるペニスによって拡張されている…
		IF ( TALENT:奴隷:マゾ || ABL:奴隷:マゾっ気 > 2 ) && EXP:奴隷:Ａ拡張経験 < 450
			CUP:奴隷:欲情 += 500
			CUP:奴隷:苦痛 += 250
		ELSEIF EXP:奴隷:Ａ拡張経験 < 450
			CUP:奴隷:苦痛 += 500
		ENDIF
	ENDIF
	SIF !TALENT:奴隷:親愛
		EXP:奴隷:浮気Ａ性交経験 ++
	CALL NTR_GET_WEAKNESS_2(奴隷)
	;あなたが訪問者の行為対象者と同じ場所にいない時に限り実行
	SIF CFLAG:MASTER:現在位置 != CFLAG:奴隷:現在位置
		CALL EXP_GOT_CHECK(奴隷)
	;汚れの付与
	CALL STAIN_MOVE_BY_PENIS(部位_Ａ, 奴隷, 人物_訪問者)
	IF 射精
		CALL EJACULATION_A(奴隷, 調教者)
		CFLAG:奴隷:持帰Ａ射精回数 += 1
	ENDIF
	IF 調教者==人物_訪問者
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 0

;-------------------------------------------------------------------------------
;Ｖを使う場合の判定（共通）
@NTR_Insert_V(奴隷,調教者,射精)
	#DIM 奴隷
	#DIM 調教者
	#DIM 射精
	TEQUIP:奴隷:Ｖセックス = 調教者
	EXP:奴隷:Ｖ経験 ++
	EXP:奴隷:Ｖ性交経験 ++
	IF TALENT:奴隷:親愛
		EXP:奴隷:緊縛経験 ++
		EXP:奴隷:被強姦経験 ++
		EXP:奴隷:被輪姦経験 ++
	ENDIF
	IF 調教者==人物_訪問者 && 訪問者_Ｐ大きさ == 2
		EXP:奴隷:Ｖ拡張経験 += 1
		SIF GETBIT(FLAG:ＮＴＲパッチ設定,32) || CFLAG:MASTER:現在位置 == CFLAG:奴隷:現在位置
			PRINTFORML %CALLNAME:奴隷%の膣は、%NTR_NAME(0)%の大きすぎるペニスによって拡張されている…
		IF ( TALENT:奴隷:マゾ || ABL:奴隷:マゾっ気 > 2 ) && EXP:奴隷:Ｖ拡張経験 < 450
			CUP:奴隷:欲情 += 500
			CUP:奴隷:苦痛 += 250
		ELSEIF EXP:奴隷:Ｖ拡張経験 < 450
			CUP:奴隷:苦痛 += 500
		ENDIF
	ENDIF
	SIF !TALENT:奴隷:親愛
		EXP:奴隷:浮気Ｖ性交経験 ++
	CALL NTR_GET_WEAKNESS_2(奴隷)
	;あなたが訪問者の行為対象者と同じ場所にいない時に限り実行
	SIF CFLAG:MASTER:現在位置 != CFLAG:奴隷:現在位置
		CALL EXP_GOT_CHECK(奴隷)
	;汚れの付与
	CALL STAIN_MOVE_BY_PENIS(部位_Ｖ, 奴隷, 人物_訪問者)
	IF TALENT:奴隷:処女
		;処女であれば破瓜
		;処女/再生処女フラグを保存
		CFLAG:奴隷:処女喪失中 = TALENT:奴隷:処女
		CALL LOST_VIRGIN(奴隷, 調教者)
		;VisitorGotItAlready activated to prevent double message
		FLAG:9059 = 1
		;calling this message to show it right after to prevent the bug when player pops the cherry on the same or next turn
		CALL LOSEVIRGINTEXT(調教者)
		IF 調教者 == 人物_客 && TALENT:奴隷:公衆便所 > 0
			CFLAG:奴隷:前回売春フラグ |= 前回売春_処女喪失
		ENDIF
	ENDIF
	IF 射精
		CALL EJACULATION_V(奴隷, 調教者)
		CFLAG:奴隷:持帰Ｖ射精回数 += 1
	ENDIF
	IF 調教者==人物_訪問者
		CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()
	ENDIF
RETURN 0

;-------------------------------------------------------------------------------
;	お持ち帰り長期滞在関係
;-------------------------------------------------------------------------------
;-------------------------------------------------------------------------------
;現在の長期滞在日数を得る
;@return 0〜7の整数
@NTR_GET_STAYOUT_CURRENT(奴隷)
	#FUNCTION
	#DIM 奴隷
RETURNF (CFLAG:奴隷:長期滞在最大日数 & 0b00001111)

;-------------------------------------------------------------------------------
;長期滞在最大日数を得る
;@return 0〜7の整数
@NTR_GET_STAYOUT_MAXIMUM(奴隷)
	#FUNCTION
	#DIM 奴隷
RETURNF (CFLAG:奴隷:長期滞在最大日数 & 0b11110000) >> 4

;-------------------------------------------------------------------------------
;現在の長期滞在日数を保存する(基本的に0にリセットする用)
@NTR_SET_STAYOUT_CURRENT(奴隷,日数)
	#DIM 奴隷
	#DIM 日数
	;1〜4ビット目を0にした後、日数を加算
	CFLAG:奴隷:長期滞在最大日数 &= ~0b00001111
	CFLAG:奴隷:長期滞在最大日数 += (日数 & 0b00001111)
RETURN 0

;-------------------------------------------------------------------------------
;長期滞在最大日数を保存する
@NTR_SET_STAYOUT_MAXIMUM(奴隷,日数)
	#DIM 奴隷
	#DIM 日数
	;5〜8ビット目を0にした後、日数を左4ビットシフトして 0bXXXX0000 を作り加算
	CFLAG:奴隷:長期滞在最大日数 &= ~0b11110000
	CFLAG:奴隷:長期滞在最大日数 += ((日数 & 0b00001111) << 4)
RETURN 0

;-------------------------------------------------------------------------------
;	お持ち帰りからの帰宅時処理
;-------------------------------------------------------------------------------
;-------------------------------------------------------------------------------
;朝のご奉仕(フェラチオ)
@NTR_MORNING_SERVICE_FELLATIO(奴隷)
	#DIM 奴隷
	CALL EJACULATION_M(奴隷, 人物_訪問者)
	EXP:奴隷:口淫経験 ++
	IF !TALENT:奴隷:親愛
		EXP:奴隷:浮気口淫経験 ++
	ENDIF
	IF NTR_CHK_VISIBLE(900)
		CALL NTR_MESSAGE_14_0(奴隷)
		TRYCALLLIST
			FUNC NTR_KOJO_K{CFLAG:奴隷:297}_14_0(奴隷)
			FUNC NTR_KOJO_K_14_0(奴隷)
		ENDFUNC
	ENDIF
	;手
	CALL STAIN_ADD_SEMEN_HAND(奴隷, 人物_訪問者)
	;好感度吸収
	CALL NTR_DRAIN_LOVE(奴隷, 20)

;-------------------------------------------------------------------------------
;朝のご奉仕(Ａ性交)
@NTR_MORNING_SERVICE_ASEX(奴隷)
	#DIM 奴隷
	CALL EJACULATION_A(奴隷, 人物_訪問者)
	EXP:奴隷:Ａ経験 ++
	EXP:奴隷:Ａ性交経験 ++
	EXP:奴隷:Ａ絶頂経験 ++
	EXP:奴隷:絶頂経験 ++
	IF 訪問者_Ｐ大きさ == 2
		EXP:奴隷:Ａ拡張経験 += 1
		SIF GETBIT(FLAG:ＮＴＲパッチ設定,32) || CFLAG:MASTER:現在位置 == CFLAG:奴隷:現在位置
			PRINTFORML %CALLNAME:奴隷%のアヌスは、%NTR_NAME(0)%の大きすぎるペニスによって拡張されている…
		IF ( TALENT:奴隷:マゾ || ABL:奴隷:マゾっ気 > 2 ) && EXP:奴隷:Ａ拡張経験 < 450
			CUP:奴隷:欲情 += 500
			CUP:奴隷:苦痛 += 250
		ELSEIF EXP:奴隷:Ａ拡張経験 < 450
			CUP:奴隷:苦痛 += 500
		ENDIF
	ENDIF
	IF !TALENT:奴隷:親愛
		EXP:奴隷:浮気Ａ性交経験 ++
		EXP:奴隷:浮気絶頂経験 ++
	ENDIF
	CALL NTR_GET_WEAKNESS_2(奴隷)
	;A感覚が高いと絶頂経験加算（強絶頂扱い）
	CALL NTR_A_EXP_PLUS(奴隷)
	IF NTR_CHK_VISIBLE(900)
		CALL NTR_MESSAGE_14_1(奴隷)
		TRYCALLLIST
			FUNC NTR_KOJO_K{CFLAG:奴隷:297}_14_1(奴隷)
			FUNC NTR_KOJO_K_14_1(奴隷)
		ENDFUNC
	ENDIF
	;好感度吸収
	CALL NTR_DRAIN_LOVE(奴隷, 50)
	;快楽経験追加
	CALL EXP_GOT_CHECK(奴隷)
	CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()

;-------------------------------------------------------------------------------
;朝のご奉仕(性交)
@NTR_MORNING_SERVICE_VSEX(奴隷)
	#DIM 奴隷
	CALL EJACULATION_V(奴隷, 人物_訪問者)
	EXP:奴隷:Ｖ経験 ++
	EXP:奴隷:Ｖ性交経験 ++
	EXP:奴隷:Ｖ絶頂経験 ++
	EXP:奴隷:絶頂経験 ++
	IF 訪問者_Ｐ大きさ == 2
		EXP:奴隷:Ｖ拡張経験 += 1
		SIF GETBIT(FLAG:ＮＴＲパッチ設定,32) || CFLAG:MASTER:現在位置 == CFLAG:奴隷:現在位置
			PRINTFORML %CALLNAME:奴隷%の膣は、%NTR_NAME(0)%の大きすぎるペニスによって拡張されている…
		IF ( TALENT:奴隷:マゾ || ABL:奴隷:マゾっ気 > 2 ) && EXP:奴隷:Ｖ拡張経験 < 450
			CUP:奴隷:欲情 += 500
			CUP:奴隷:苦痛 += 250
		ELSEIF EXP:奴隷:Ｖ拡張経験 < 450
			CUP:奴隷:苦痛 += 500
		ENDIF
	ENDIF
	IF !TALENT:奴隷:親愛
		EXP:奴隷:浮気Ｖ性交経験 ++
		EXP:奴隷:浮気絶頂経験 ++
	ENDIF
	CALL NTR_GET_WEAKNESS_2(奴隷)
	;V感覚が高いと絶頂経験加算（強絶頂扱い）
	CALL NTR_V_EXP_PLUS(奴隷)
	IF NTR_CHK_VISIBLE(900)
		CALL NTR_MESSAGE_14_2(奴隷)
		TRYCALLLIST
			FUNC NTR_KOJO_K{CFLAG:奴隷:297}_14_2(奴隷)
			FUNC NTR_KOJO_K_14_2(奴隷)
		ENDFUNC
	ENDIF
	;好感度吸収
	CALL NTR_DRAIN_LOVE(奴隷, 50)
	;快楽経験追加
	CALL EXP_GOT_CHECK(奴隷)
	CFLAG:奴隷:NTR訪問者と最後にセックスした日時 = DATETIME()

;-------------------------------------------------------------------------------
;公衆便所時の汚染追加
@MORNING_ADD_STAIN(奴隷)
	#DIM 奴隷
	IF TALENT:奴隷:公衆便所
		;手
		CALL STAIN_ADD_SEMEN_HAND(奴隷, 人物_訪問者)
		;胸
		CALL STAIN_ADD_SEMEN_B(奴隷, 人物_訪問者)
		EXP:奴隷:口淫経験 ++
		IF !TALENT:奴隷:親愛
			EXP:奴隷:浮気口淫経験 ++
		ENDIF
		CALL EJACULATION_M(奴隷, 人物_訪問者)
		;A
		EXP:奴隷:Ａ経験 ++
		EXP:奴隷:Ａ性交経験 ++
		EXP:奴隷:Ａ絶頂経験 ++
		EXP:奴隷:絶頂経験 ++
		IF !TALENT:奴隷:親愛
			EXP:奴隷:浮気Ａ性交経験 ++
			EXP:奴隷:浮気絶頂経験 ++
		ENDIF
		CALL NTR_GET_WEAKNESS_2(奴隷)
		CALL EJACULATION_A(奴隷, 人物_訪問者)
		;A感覚が高いと絶頂経験加算（強絶頂扱い）
		CALL NTR_A_EXP_PLUS(奴隷)
		;V
		IF !TALENT:奴隷:処女
			EXP:奴隷:Ｖ経験 ++
			EXP:奴隷:Ｖ性交経験 ++
			EXP:奴隷:Ｖ絶頂経験 ++
			EXP:奴隷:絶頂経験 ++
			IF !TALENT:奴隷:親愛
				EXP:奴隷:浮気Ｖ性交経験 ++
				EXP:奴隷:浮気絶頂経験 ++
			ENDIF
			CALL NTR_GET_WEAKNESS_2(奴隷)
			CALL EJACULATION_V(奴隷, 人物_訪問者)
			;V感覚が高いと絶頂経験加算（強絶頂扱い）
			CALL NTR_V_EXP_PLUS(奴隷)
		ENDIF
		;好感度吸収			
		CALL NTR_DRAIN_LOVE(奴隷, 50)
	ENDIF
