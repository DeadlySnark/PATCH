;-------------------------------------------------------------------------------
;β’Έn‚Μ—‚Θ‚Η
;-------------------------------------------------
;β’Έ—
;-------------------------------------------------
@ORGASM_ADD(“z—κ,’²‹³=0)
	#DIM “z—κ
	#DIM ’²‹³
	#DIM β’Έ—v‹W”
	#DIM ‘‡‰υ΄’l
	#DIM •”Κ‰υ΄’l
	#DIM β’Έσ•β
	#DIM ‚`β’Έ‹­“x
	#DIM ‚aβ’Έ‹­“x
	#DIM ‚bβ’Έ‹­“x
	#DIM ‚uβ’Έ‹­“x
	#DIM •‚‹C‰υy‹­“x
	
	β’Έσ•β = 0
	β’Έσ•β += ((CUP:“z—κ:‰υ‚b + PALAM:“z—κ:‰υ‚b) >= PALAMLV:4)
	β’Έσ•β += ((CUP:“z—κ:‰υ‚u + PALAM:“z—κ:‰υ‚u) >= PALAMLV:4)
	β’Έσ•β += ((CUP:“z—κ:‰υ‚` + PALAM:“z—κ:‰υ‚`) >= PALAMLV:4)
	β’Έσ•β += ((CUP:“z—κ:‰υ‚a + PALAM:“z—κ:‰υ‚a) >= PALAMLV:4)
	SELECTCASE β’Έσ•β
		CASE 4
			‘‡‰υ΄’l = 7000
		CASE 3
			‘‡‰υ΄’l = 5000
		CASE 2
			‘‡‰υ΄’l = 3000
		CASE 1
			‘‡‰υ΄’l = 2000
	ENDSELECT
	;‹”F«‚Μ–β‘θ‚Εc‚µ‚Δ‚¨‚­
	‚bβ’Έ‹­“x = 0
	‚uβ’Έ‹­“x = 0
	‚`β’Έ‹­“x = 0
	‚aβ’Έ‹­“x = 0
	
	;–K–βΘO‚Μ’²‹³‚ΕA‰υyσ‚ζ‚θ‚ΰ•‚‹C‰υyσ‚Μƒƒxƒ‹‚‚‚Άκ‡Aβ’Έ‚µ‚Γ‚η‚­‚Θ‚ι
	IF ’²‹³ != 998 && GET_MARK_LEVEL(“z—κ,σ”Τ†_‰υyσ,’²‹³) < MARK:“z—κ:•‚‹C‰υyσ
		β’Έ—v‹W” = MAX( 100 * MARK:“z—κ:•‚‹C‰υyσ / MAX(1,GET_MARK_LEVEL(“z—κ,σ”Τ†_‰υyσ,’²‹³)) , 100 )
	ELSE
		β’Έ—v‹W” = 100
	ENDIF
	
	;-------------------------------------------------------------------
	;β’Έ‚b
	•”Κ‰υ΄’l = (CUP:“z—κ:‰υ‚b > 0) * ‘‡‰υ΄’l
	IF CUP:“z—κ:‰υ‚b + PALAM:“z—κ:‰υ‚b + •”Κ‰υ΄’l >= PALAMLV:4 * 2 * β’Έ—v‹W” / 100
		‚bβ’Έ‹­“x = 2
		CDOWN:“z—κ:‰υ‚b = PALAMLV:4 * 2 - •”Κ‰υ΄’l
	ELSEIF CUP:“z—κ:‰υ‚b + PALAM:“z—κ:‰υ‚b + •”Κ‰υ΄’l >= PALAMLV:4 * β’Έ—v‹W” / 100
		‚bβ’Έ‹­“x = 1
		CDOWN:“z—κ:‰υ‚b = PALAMLV:4 - •”Κ‰υ΄’l
	ELSEIF CUP:“z—κ:‰υ‚b + PALAM:“z—κ:‰υ‚b + •”Κ‰υ΄’l >= PALAMLV:4
		;ƒC‚―‚ι‚Ν‚Έ‚Θ‚Μ‚ΙƒC‚―‚Θ‚©‚Α‚½κ‡
		NOWEX:“z—κ:β’Έ‰‰‹Z++
	ENDIF
	;CDOWN:“z—κ:‰υ‚b‚Ε‰Ί‚°‚Δ‚ΰβ’ΈΘγ‚Θ‚η
	;‚»‚Μ’l-1‚Ι‚Θ‚ι‚ζ‚¤‚Ι’²®i10000‚Εβ’Έ‚Θ‚η9999j
	SIF CUP:“z—κ:‰υ‚b + PALAM:“z—κ:‰υ‚b - CDOWN:“z—κ:‰υ‚b >= PALAMLV:4
		CDOWN:“z—κ:‰υ‚b = CUP:“z—κ:‰υ‚b + PALAM:“z—κ:‰υ‚b - PALAMLV:4 + 1
	;-------------------------------------------------------------------
	;β’Έ‚u
	•”Κ‰υ΄’l = (CUP:“z—κ:‰υ‚u > 0) * ‘‡‰υ΄’l
	IF CUP:“z—κ:‰υ‚u + PALAM:“z—κ:‰υ‚u + •”Κ‰υ΄’l >= PALAMLV:4 * 2 * β’Έ—v‹W” / 100
		‚uβ’Έ‹­“x = 2
		CDOWN:“z—κ:‰υ‚u = PALAMLV:4 * 2 - •”Κ‰υ΄’l
	ELSEIF CUP:“z—κ:‰υ‚u + PALAM:“z—κ:‰υ‚u + •”Κ‰υ΄’l >= PALAMLV:4 * β’Έ—v‹W” / 100
		‚uβ’Έ‹­“x = 1
		CDOWN:“z—κ:‰υ‚u = PALAMLV:4 - •”Κ‰υ΄’l
	ELSEIF CUP:“z—κ:‰υ‚u + PALAM:“z—κ:‰υ‚u + •”Κ‰υ΄’l >= PALAMLV:4
		;ƒC‚―‚ι‚Ν‚Έ‚Θ‚Μ‚ΙƒC‚―‚Θ‚©‚Α‚½κ‡
		NOWEX:“z—κ:β’Έ‰‰‹Z++
	ENDIF
	;CDOWN:“z—κ:‰υ‚u‚Ε‰Ί‚°‚Δ‚ΰβ’ΈΘγ‚Θ‚η
	;‚»‚Μ’l-1‚Ι‚Θ‚ι‚ζ‚¤‚Ι’²®i10000‚Εβ’Έ‚Θ‚η9999j
	SIF CUP:“z—κ:‰υ‚u + PALAM:“z—κ:‰υ‚u - CDOWN:“z—κ:‰υ‚u >= PALAMLV:4
		CDOWN:“z—κ:‰υ‚u = CUP:“z—κ:‰υ‚u + PALAM:“z—κ:‰υ‚u - PALAMLV:4 + 1
	;-------------------------------------------------------------------
	;β’Έ‚`
	•”Κ‰υ΄’l = (CUP:“z—κ:‰υ‚` > 0) * ‘‡‰υ΄’l
	IF CUP:“z—κ:‰υ‚` + PALAM:“z—κ:‰υ‚` + •”Κ‰υ΄’l >= PALAMLV:4 * 2 * β’Έ—v‹W” / 100
		‚`β’Έ‹­“x = 2
		CDOWN:“z—κ:‰υ‚` = PALAMLV:4 * 2 - •”Κ‰υ΄’l
	ELSEIF CUP:“z—κ:‰υ‚` + PALAM:“z—κ:‰υ‚` + •”Κ‰υ΄’l >= PALAMLV:4 * β’Έ—v‹W” / 100
		‚`β’Έ‹­“x = 1
		CDOWN:“z—κ:‰υ‚` = PALAMLV:4 - •”Κ‰υ΄’l
	ELSEIF CUP:“z—κ:‰υ‚` + PALAM:“z—κ:‰υ‚` + •”Κ‰υ΄’l >= PALAMLV:4
		;ƒC‚―‚ι‚Ν‚Έ‚Θ‚Μ‚ΙƒC‚―‚Θ‚©‚Α‚½κ‡
		NOWEX:“z—κ:β’Έ‰‰‹Z++
	ENDIF
	;CDOWN:“z—κ:‰υ‚`‚Ε‰Ί‚°‚Δ‚ΰβ’ΈΘγ‚Θ‚η
	;‚»‚Μ’l-1‚Ι‚Θ‚ι‚ζ‚¤‚Ι’²®i10000‚Εβ’Έ‚Θ‚η9999j
	SIF CUP:“z—κ:‰υ‚` + PALAM:“z—κ:‰υ‚` - CDOWN:“z—κ:‰υ‚` >= PALAMLV:4
		CDOWN:“z—κ:‰υ‚` = CUP:“z—κ:‰υ‚` + PALAM:“z—κ:‰υ‚` - PALAMLV:4 + 1
	;-------------------------------------------------------------------
	;β’Έ‚a
	•”Κ‰υ΄’l = (CUP:“z—κ:‰υ‚a > 0) * ‘‡‰υ΄’l
	IF CUP:“z—κ:‰υ‚a + PALAM:“z—κ:‰υ‚a + •”Κ‰υ΄’l >= PALAMLV:4 * 2 * β’Έ—v‹W” / 100
		‚aβ’Έ‹­“x = 2
		CDOWN:“z—κ:‰υ‚a = (PALAMLV:4 * 2 - 1000) - •”Κ‰υ΄’l
	ELSEIF CUP:“z—κ:‰υ‚a + PALAM:“z—κ:‰υ‚a + •”Κ‰υ΄’l >= PALAMLV:4 * β’Έ—v‹W” / 100
		‚aβ’Έ‹­“x = 1
		CDOWN:“z—κ:‰υ‚a = (PALAMLV:4 - 1000) - •”Κ‰υ΄’l
	ELSEIF CUP:“z—κ:‰υ‚a + PALAM:“z—κ:‰υ‚a + •”Κ‰υ΄’l >= PALAMLV:4
		;ƒC‚―‚ι‚Ν‚Έ‚Θ‚Μ‚ΙƒC‚―‚Θ‚©‚Α‚½κ‡
		NOWEX:“z—κ:β’Έ‰‰‹Z++
	ENDIF
	;CDOWN:“z—κ:‰υ‚a‚Ε‰Ί‚°‚Δ‚ΰβ’ΈΘγ‚Θ‚η
	;‚»‚Μ’l-1‚Ι‚Θ‚ι‚ζ‚¤‚Ι’²®i10000‚Εβ’Έ‚Θ‚η9999j
	SIF CUP:“z—κ:‰υ‚a + PALAM:“z—κ:‰υ‚a - CDOWN:“z—κ:‰υ‚a >= PALAMLV:4
		CDOWN:“z—κ:‰υ‚a = CUP:“z—κ:‰υ‚a + PALAM:“z—κ:‰υ‚a - PALAMLV:4 + 1
	;-------------------------------------------------
	;β’Έ‚Μ’Η‰Α—
	;-------------------------------------------------
	;‰υyσ‚Μ—
	;β’Έ‚Μ•”Κ‚Ζ‹­“x‚Μ‡v‚κ’θΘγ‚Εσ‚πζ“Ύ‚·‚ι
	LOCAL = ‚bβ’Έ‹­“x + ‚uβ’Έ‹­“x * 2 + ‚`β’Έ‹­“x * 2 + ‚aβ’Έ‹­“x
	;R‚4Θγ‚Ε‰υyσ‚R‚Ι‘“–
	IF LOCAL >= 3 && MARK:“z—κ:‰υyσ < 3
		TCVAR:“z—κ:‰υy‹­“x = 3
		;R‚3Θγ‚Ε‰υyσ‚Q‚Ι‘“–
	ELSEIF LOCAL >= 2 && MARK:“z—κ:‰υyσ < 2
		TCVAR:“z—κ:‰υy‹­“x = 2
		;R‚2Θγ‚Ε‰υyσ‚P‚Ι‘“–
	ELSEIF LOCAL >= 1 && MARK:“z—κ:‰υyσ < 1
		TCVAR:“z—κ:‰υy‹­“x = 1
	ELSE
		TCVAR:“z—κ:‰υy‹­“x = 0
	ENDIF
	IF ‚bβ’Έ‹­“x && ‚uβ’Έ‹­“x && ‚`β’Έ‹­“x && ‚aβ’Έ‹­“x
		‚bβ’Έ‹­“x *= 8
		‚uβ’Έ‹­“x *= 8
		‚`β’Έ‹­“x *= 8
		‚aβ’Έ‹­“x *= 8
		NOWEX:“z—κ:ldβ’Έ = 1
	ELSEIF ‚bβ’Έ‹­“x && ‚uβ’Έ‹­“x && ‚`β’Έ‹­“x
		‚bβ’Έ‹­“x *= 4
		‚uβ’Έ‹­“x *= 4
		‚`β’Έ‹­“x *= 4
		NOWEX:“z—κ:Odβ’Έ = 1
	ELSEIF ‚aβ’Έ‹­“x && ‚uβ’Έ‹­“x && ‚`β’Έ‹­“x
		‚aβ’Έ‹­“x *= 4
		‚uβ’Έ‹­“x *= 4
		‚`β’Έ‹­“x *= 4
		NOWEX:“z—κ:Odβ’Έ = 2
	ELSEIF ‚bβ’Έ‹­“x && ‚aβ’Έ‹­“x && ‚`β’Έ‹­“x
		‚bβ’Έ‹­“x *= 4
		‚aβ’Έ‹­“x *= 4
		‚`β’Έ‹­“x *= 4
		NOWEX:“z—κ:Odβ’Έ = 3
	ELSEIF ‚bβ’Έ‹­“x && ‚uβ’Έ‹­“x && ‚aβ’Έ‹­“x
		‚bβ’Έ‹­“x *= 4
		‚uβ’Έ‹­“x *= 4
		‚aβ’Έ‹­“x *= 4
		NOWEX:“z—κ:Odβ’Έ = 4
	ELSEIF ‚bβ’Έ‹­“x && ‚uβ’Έ‹­“x
		‚bβ’Έ‹­“x *= 2
		‚uβ’Έ‹­“x *= 2
		NOWEX:“z—κ:“ρdβ’Έ = 1
	ELSEIF ‚bβ’Έ‹­“x && ‚`β’Έ‹­“x
		‚bβ’Έ‹­“x *= 2
		‚`β’Έ‹­“x *= 2
		NOWEX:“z—κ:“ρdβ’Έ = 2
	ELSEIF ‚uβ’Έ‹­“x && ‚`β’Έ‹­“x
		‚uβ’Έ‹­“x *= 2
		‚`β’Έ‹­“x *= 2
		NOWEX:“z—κ:“ρdβ’Έ = 3
	ELSEIF ‚bβ’Έ‹­“x && ‚aβ’Έ‹­“x
		‚bβ’Έ‹­“x *= 2
		‚aβ’Έ‹­“x *= 2
		NOWEX:“z—κ:“ρdβ’Έ = 4
	ELSEIF ‚uβ’Έ‹­“x && ‚aβ’Έ‹­“x
		‚uβ’Έ‹­“x *= 2
		‚aβ’Έ‹­“x *= 2
		NOWEX:“z—κ:“ρdβ’Έ = 5
	ELSEIF ‚`β’Έ‹­“x && ‚aβ’Έ‹­“x
		‚`β’Έ‹­“x *= 2
		‚aβ’Έ‹­“x *= 2
		NOWEX:“z—κ:“ρdβ’Έ = 6
	ENDIF
	IF ‚bβ’Έ‹­“x
		SOURCE:“z—κ:Io += 500 * ‚bβ’Έ‹­“x
		SOURCE:“z—κ:‹ό] += 200 * ‚bβ’Έ‹­“x
		SOURCE:“z—κ:”½΄ += 150 * ‚bβ’Έ‹­“x
		DOWNBASE:“z—κ:‘Μ—Ν += 20
		DOWNBASE:“z—κ:‹C—Ν += 10
	ENDIF
	IF ‚uβ’Έ‹­“x
		SOURCE:“z—κ:—~ξ += 800 * ‚uβ’Έ‹­“x
		SOURCE:“z—κ:‹±‡ += 500 * ‚uβ’Έ‹­“x
		SOURCE:“z—κ:Io += 700 * ‚uβ’Έ‹­“x
		SOURCE:“z—κ:‹ό] += 400 * ‚uβ’Έ‹­“x
		SOURCE:“z—κ:”½΄ += 300 * ‚uβ’Έ‹­“x
		DOWNBASE:“z—κ:‘Μ—Ν += 40
		DOWNBASE:“z—κ:‹C—Ν += 20
	ENDIF
	IF ‚`β’Έ‹­“x
		SOURCE:“z—κ:—~ξ += 500 * ‚`β’Έ‹­“x
		SOURCE:“z—κ:‹±‡ += 700 * ‚`β’Έ‹­“x
		SOURCE:“z—κ:Io += 900 * ‚`β’Έ‹­“x
		SOURCE:“z—κ:‹ό] += 500 * ‚`β’Έ‹­“x
		SOURCE:“z—κ:”½΄ += 400 * ‚`β’Έ‹­“x
		DOWNBASE:“z—κ:‘Μ—Ν += 60
		DOWNBASE:“z—κ:‹C—Ν += 30
	ENDIF
	IF ‚aβ’Έ‹­“x
		SOURCE:“z—κ:Io += 500 * ‚aβ’Έ‹­“x
		SOURCE:“z—κ:‹ό] += 200 * ‚aβ’Έ‹­“x
		SOURCE:“z—κ:”½΄ += 150 * ‚aβ’Έ‹­“x
		DOWNBASE:“z—κ:‘Μ—Ν += 20
		DOWNBASE:“z—κ:‹C—Ν += 10
	ENDIF
	;NOWEX‚Ιƒf[ƒ^‚π“ό‚κ‚ιiβ’Έϋγ‚Ιg‚¤j
	NOWEX:“z—κ:‚bβ’Έ = ‚bβ’Έ‹­“x
	NOWEX:“z—κ:‚uβ’Έ = ‚uβ’Έ‹­“x
	NOWEX:“z—κ:‚`β’Έ = ‚`β’Έ‹­“x
	NOWEX:“z—κ:‚aβ’Έ = ‚aβ’Έ‹­“x
	;β’Έ‰ρ”‚π‘‚β‚·
	EX:“z—κ:‚bβ’Έ += ‚bβ’Έ‹­“x
	EX:“z—κ:‚uβ’Έ += ‚uβ’Έ‹­“x
	EX:“z—κ:‚`β’Έ += ‚`β’Έ‹­“x
	EX:“z—κ:‚aβ’Έ += ‚aβ’Έ‹­“x
	;β’Έo±‚π‘
	EXP:“z—κ:β’Έo± += ‚bβ’Έ‹­“x + ‚uβ’Έ‹­“x + ‚`β’Έ‹­“x + ‚aβ’Έ‹­“x
	EXP:“z—κ:‚bβ’Έo± += ‚bβ’Έ‹­“x
	EXP:“z—κ:‚uβ’Έo± += ‚uβ’Έ‹­“x
	EXP:“z—κ:‚`β’Έo± += ‚`β’Έ‹­“x
	EXP:“z—κ:‚aβ’Έo± += ‚aβ’Έ‹­“x
	;ƒrƒfƒI
	IF TEQUIP:“z—κ:ƒrƒfƒIB‰e
		IF NOWEX:“z—κ:ldβ’Έ
			LOCALS = O2/O3/O4/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ENDIF
		IF NOWEX:“z—κ:Odβ’Έ
			LOCALS = O2/O3/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ENDIF
		IF NOWEX:“z—κ:“ρdβ’Έ
			LOCALS = O2/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ENDIF
		IF NOWEX:“z—κ:‚bβ’Έ == 2
			LOCALS = C/C/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ELSEIF NOWEX:“z—κ:‚bβ’Έ == 1
			LOCALS = C/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ENDIF
		IF NOWEX:“z—κ:‚uβ’Έ == 2
			LOCALS = V/V/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ELSEIF NOWEX:“z—κ:‚uβ’Έ == 1
			LOCALS = V/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ENDIF
		IF NOWEX:“z—κ:‚`β’Έ == 2
			LOCALS = A/A/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ELSEIF NOWEX:“z—κ:‚`β’Έ == 1
			LOCALS = A/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ENDIF
		IF NOWEX:“z—κ:‚aβ’Έ == 2
			LOCALS = B/B/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ELSEIF NOWEX:“z—κ:‚aβ’Έ == 1
			LOCALS = B/
			TSTR:“®‰ζB‰e‹L^ += LOCALS
		ENDIF
	ENDIF

RETURN LOCAL

;-------------------------------------------------------------------------------
;FIXME:Φ”‚Μΰ–Ύ‚π‘‚Ά‚Δ‚­‚Ύ‚³‚Ά
;@return 1:xxx,0:xxx
@MESSAGE_PALAMCNG_B2
SETCOLOR 255, 180, 0
	IF NOWEX:6
		IF !GETBIT(CFLAG:3,2)
			EXP:Ωνo± ++
			SETBIT CFLAG:Ωνo±,2
		ENDIF
		FONTBOLD
		PRINTFORML %"Quadruple Orgasm!"%
		FONTREGULAR
		PRINTFORML %"(Gems Multiplier x8)"%
	ELSEIF NOWEX:5
		SELECTCASE NOWEX:5
			CASE 1
				PRINTFORML %"C&V&A Orgasms"%
				PRINTFORML %"(Gems Multiplier x4)"%
			CASE 2
				PRINTFORML %"B&V&A Orgasms"%
				PRINTFORML %"(Gems Multiplier x4)"%
			CASE 3
				PRINTFORML %"C&B&A Orgasms"%
				PRINTFORML %"(Gems Multiplier x4)"%
			CASE 4
				PRINTFORML %"C&V&B Orgasms"%
				PRINTFORML %"(Gems Multiplier x4)"%
		ENDSELECT
	ELSEIF NOWEX:4
		SELECTCASE NOWEX:4
			CASE 1
				PRINTFORML %"C&V Orgasms"%
				PRINTFORML %"(Gems Multiplier x2)"%
			CASE 2
				PRINTFORML %"C&A Orgasms"%
				PRINTFORML %"(Gems Multiplier x2)"%
			CASE 3
				PRINTFORML %"V&A Orgasms"%
				PRINTFORML %"(Gems Multiplier x2)"%
			CASE 4
				PRINTFORML %"C&B Orgasms"%
				PRINTFORML %"(Gems Multiplier x2)"%
			CASE 5
				PRINTFORML %"V&B Orgasms"%
				PRINTFORML %"(Gems Multiplier x2)"%
			CASE 6
				PRINTFORML %"A&B Orgasms"%
				PRINTFORML %"(Gems Multiplier x2)"%
		ENDSELECT
	ELSEIF NOWEX:3
		IF NOWEX:3 == 2
			PRINTFORML %"Strong B Orgasm"%
		ELSE
			PRINTFORML %"B Orgasm"%
		ENDIF
	ELSEIF NOWEX:2
		IF NOWEX:2 == 2
			PRINTFORML %"Strong A Orgasm"%
		ELSE
			PRINTFORML %"A Orgasm"%
		ENDIF
	ELSEIF NOWEX:1
		IF NOWEX:1 == 2
			PRINTFORML %"Strong V Orgasm"%
		ELSE
			PRINTFORML %"V Orgasm"%
		ENDIF
	ELSEIF NOWEX:0
		IF NOWEX:0 == 2
			PRINTFORML %"Strong C Orgasm"%
		ELSE
			PRINTFORML %"C Orgasm"%
		ENDIF
	ENDIF
	RESETCOLOR
	;β’Έ‚Ι‚ζ‚ι—~–]‚k‚uƒAƒbƒv
	LOCAL = 0
	SIF NOWEX:0 >= 2 || NOWEX:‚aβ’Έ >= 2 || NOWEX:‚uβ’Έ || NOWEX:‚`β’Έ
		LOCAL = 1
	SIF NOWEX:1 >= 2 || NOWEX:‚`β’Έ >= 2
		LOCAL = 2
	SIF (NOWEX:0 >= 2 || NOWEX:‚aβ’Έ >= 2) && NOWEX:4
		LOCAL = 2
	SIF NOWEX:5
		LOCAL = 3
	SIF NOWEX:6
		LOCAL = 4
	;©§S‚‚ ‚ι‚Ζ‚P‰Ί‚‚ι
	SIF TALENT:©§S
		LOCAL -= 1
	IF ABL:—~–] < LOCAL
		ABL:—~–] ++
		FONTBOLD
		SETCOLOR COLOR("ORANGE")
		PRINTFORML Lust has been increased to LV{LOCAL}!
		RESETCOLOR
		FONTREGULAR
		;—~–]‚ΜγΈ‚Ι‚ζ‚ι[—}³]‚ΜΑ–Ε‚πƒ`ƒFƒbƒN
		CALL YOKUBO_UP_CHECK
	ENDIF
	PRINTL 

;-------------------------------------------------
;’²‹³‘ΞΫ‚Μ•¬“ϋƒ`ƒFƒbƒN
;-------------------------------------------------
@TARGET_MILK_CHECK(“z—κ)
	#DIM “z—κ
	#DIM •κ“ϋ’~Οξ€’l
	#DIM •κ“ϋ•¬o—Κ
	#DIM •κ“ϋ’~Ο—Κ

	SIF !TALENT:“z—κ:•κ“ϋ‘ΜΏ
		RETURN 0

	;κ‡‚Ι‚ζ‚Α‚Δ‚ΝMAXBASE–Άέ’θ‚Μ‚ά‚ά—‚ι–‚‚ ‚ι‚Μ‚Ε0‚Θ‚η‹­§έ’θ‚·‚ι
	IF MAXBASE:“z—κ:•κ“ϋ == 0
		MAXBASE:“z—κ:•κ“ϋ = 5000+5000*(!TALENT:“z—κ:ϊ“ϋ)
	ENDIF

	;‰υ΄‚ΜγΈ—Κ‚©‚η•κ“ϋ’~Οξ€’l‚π’θ
	•κ“ϋ’~Οξ€’l = CUP:“z—κ:‰υ‚b/5 + CUP:“z—κ:‰υ‚u/5 + CUP:“z—κ:‰υ‚`/5 + CUP:“z—κ:‰υ‚a*3

	;’~Οξ€’l‚0A‚Β‚ά‚θhƒ‚‚Θ‚―‚κ‚Ξ“Λ‘R•¬‚«o‚µ‚½‚θ‚Ν‚µ‚Θ‚Ά
	IF (•κ“ϋ’~Οξ€’l == 0)
		RETURN 0
	ENDIF

	;Ε‘ε‚Ε‚ΰ150%‚µ‚©‘‚¦‚Θ‚Ά‚ζ‚¤‚Ι‚·‚ιi‘ε—Κ•¬“ϋ‚πΈ‚η‚·j
	•κ“ϋ’~Ο—Κ = MIN(•κ“ϋ’~Οξ€’l,MAXBASE:“z—κ:•κ“ϋ*3/2)

	;©§S‚Ώ‚Θ‚η•κ“ϋ‚’™‚ά‚θ‚Γ‚η‚Ά
	SIF TALENT:“z—κ:©§S
		•κ“ϋ’~Ο—Κ /= 2
	;‰υ΄‚Ι‘f’Ό‚Θ‚η•κ“ϋ‚’™‚ά‚θ‚β‚·‚Ά
	SIF TALENT:“z—κ:‰υ΄‰“ > 0
		TIMES •κ“ϋ’~Ο—Κ , 1.20
	;‰υ΄‚Μ”Ϋ’θ‚Θ‚η•κ“ϋ‚’™‚ά‚θ‚Γ‚η‚Άiϊ—A©•w‚Ε–³ψj
	SIF TALENT:“z—κ:‰υ΄‰“ < 0 && !TALENT:“z—κ:ϊ—
		TIMES •κ“ϋ’~Ο—Κ , 0.80
	;B•q΄‚Θ‚η•κ“ϋ‚’™‚ά‚θ‚β‚·‚Ά
	SIF TALENT:“z—κ:‚a΄“x > 0
		TIMES •κ“ϋ’~Ο—Κ , 1.20
	;›Z–ςσ‘Τ‚Θ‚η•κ“ϋ‚’™‚ά‚θ‚β‚·‚Ά
	SIF TEQUIP:“z—κ:›Z–ς
		•κ“ϋ’~Ο—Κ *= 2
	;—”Aάσ‘Τ‚Θ‚η•κ“ϋ‚’™‚ά‚θ‚Γ‚η‚Άi…•‚δNγχ‚Ι‰ρ‚ι‚©‚ηHj
	SIF TEQUIP:“z—κ:—”Aά
		•κ“ϋ’~Ο—Κ /= 2
	;’²‹³‚—c™‘ήs‚Θ‚η•κ“ϋ‚’™‚ά‚θ‚β‚·‚Ά
	SIF TALENT:PLAYER:—c™^—c™‘ήs
		TIMES •κ“ϋ’~Ο—Κ , 1.20
	;’²‹³‚—c’t‚Θ‚η•κ“ϋ‚’™‚ά‚θ‚β‚·‚Ά
	SIF TALENT:PLAYER:—c’t
		TIMES •κ“ϋ’~Ο—Κ , 1.20
	;•n“ϋ‚Θ‚η•κ“ϋ‚’™‚ά‚θ‚Γ‚η‚Ά
	SIF TALENT:“z—κ:ƒoƒXƒgƒTƒCƒY < 0
		TIMES •κ“ϋ’~Ο—Κ , 0.50

	BASE:“z—κ:•κ“ϋ += •κ“ϋ’~Ο—Κ
	
	;•¬oƒ`ƒFƒbƒNA100%Θγ’™‚ά‚Α‚Δ‚Ά‚κ‚Ξ•K‚ΈA‚»‚¤‚Ε‚Θ‚―‚κ‚Ξ—Κ‚Ζ΅‰ρσ‚―‚½hƒ‚Ι‰‚¶‚Δ•¬o—¦‚•Ο‚ν‚ι
	IF (BASE:“z—κ:•κ“ϋ > MAXBASE:“z—κ:•κ“ϋ)
		;•¬oγ‚Μ•κ“ϋ—Κ‚50%–Ά–‚Ι‚Θ‚ι‚ζ‚¤‚Ι‚·‚ι(A‘±•¬o–h~)
		•κ“ϋ•¬o—Κ = MAX( RAND(BASE:“z—κ:•κ“ϋ), (BASE:“z—κ:•κ“ϋ-MAXBASE:“z—κ:•κ“ϋ/2) )
	ELSEIF 	( RAND(MAX(CUP:“z—κ:‰υ‚a,1)) > (MAXBASE:“z—κ:•κ“ϋ-BASE:“z—κ:•κ“ϋ) )
		;100%’΄‚¦‚Δ‚Ά‚Θ‚Άκ‡‚Ν—Κ‚Ν’m‚κ‚Δ‚ι
		•κ“ϋ•¬o—Κ = MAX(RAND(BASE:“z—κ:•κ“ϋ),0)
	ENDIF
	•κ“ϋ•¬o—Κ = MIN(•κ“ϋ•¬o—Κ, BASE:“z—κ:•κ“ϋ)

	IF •κ“ϋ•¬o—Κ < 1
		RETURN 0
	ENDIF

	DOWNBASE:“z—κ:‘Μ—Ν += 20 * MAX(•κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
	DOWNBASE:“z—κ:‹C—Ν += 50 * MAX(•κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)

	IF EXP:“z—κ:•¬“ϋo± < EXPLV:1
		SOURCE:“z—κ:Io += MAX(10000 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:‹ό] += MAX( 5000 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:•s‰ += MAX( 2000 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
	ELSEIF EXP:“z—κ:•¬“ϋo± < EXPLV:2
		SOURCE:“z—κ:Io += MAX( 5000 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:‹ό] += MAX( 3000 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:•s‰ += MAX( 1500 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
	ELSEIF EXP:“z—κ:•¬“ϋo± < EXPLV:3
		SOURCE:“z—κ:Io += MAX( 3000 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:‹ό] += MAX( 1500 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:•s‰ += MAX( 1000 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
	ELSEIF EXP:“z—κ:•¬“ϋo± < EXPLV:4
		SOURCE:“z—κ:Io += MAX( 1500 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:‹ό] += MAX(  800 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:•s‰ += MAX(  700 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
	ELSEIF EXP:“z—κ:•¬“ϋo± < EXPLV:5
		SOURCE:“z—κ:Io += MAX( 1000 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:‹ό] += MAX(  500 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:•s‰ += MAX(  400 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
	ELSE
		SOURCE:“z—κ:Io += MAX(  500 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
		SOURCE:“z—κ:‹ό] += MAX(  300 * •κ“ϋ•¬o—Κ / MAXBASE:“z—κ:•κ“ϋ, 1)
	ENDIF
	CALL COLORMESSAGE(@"sLactationt(%CALLNAME:“z—κ%)",C_PINK,1,1)
	
	SELECTCASE •κ“ϋ•¬o—Κ
		CASE IS > MAXBASE:“z—κ:•κ“ϋ
			PRINTFORML Large amounts of milk erupted from %CALLNAME:“z—κ%'s %NIPPLE_DESCRIPTION(“z—κ)%.
			EXP:“z—κ:Ωνo± += (EXP:“z—κ:•¬“ϋo±==0)
			EXP:“z—κ:•¬“ϋo± += 3
			NOWEX:“z—κ:•¬“ϋ += 3
			EX:“z—κ:•¬“ϋ += 3
		CASE IS > (MAXBASE:“z—κ:•κ“ϋ/2)
			PRINTFORML A nice amount of milk gushed out from %CALLNAME:“z—κ%'s %NIPPLE_DESCRIPTION(“z—κ)%.
			EXP:“z—κ:Ωνo± += (EXP:“z—κ:•¬“ϋo±==0)
			EXP:“z—κ:•¬“ϋo± += 2
			NOWEX:“z—κ:•¬“ϋ += 2
			EX:“z—κ:•¬“ϋ += 2
		CASE IS > (MAXBASE:“z—κ:•κ“ϋ/4)
			;125%Θγ’™‚ά‚Α‚Δ‚Ά‚½
			PRINTFORML Some milk has leaked from %CALLNAME:“z—κ%'s %NIPPLE_DESCRIPTION(“z—κ)%.
			EXP:“z—κ:Ωνo± += (EXP:“z—κ:•¬“ϋo±==0)
			EXP:“z—κ:•¬“ϋo± += 1
			NOWEX:“z—κ:•¬“ϋ += 1
			EX:“z—κ:•¬“ϋ += 1
		CASEELSE
			PRINTFORML A little amount of milk oozed from %CALLNAME:“z—κ%'s %NIPPLE_DESCRIPTION(“z—κ)%.
	ENDSELECT

	;‚a‚Ι•κ“ϋ‰‚κ‚π•t‚―‚ι
	STAIN:“z—κ:‚a |= ‰‚κ_•κ“ϋ

	;•κ“ϋ‚πΈ‚η‚·
	BASE:“z—κ:•κ“ϋ -= •κ“ϋ•¬o—Κ
	;–κ‚ΜΧ‚ΙΕ‘ε•κ“ϋ-1‚Ι‚Θ‚ι‚ζ‚¤‚Ι’²®
	BASE:“z—κ:•κ“ϋ = MIN(BASE:“z—κ:•κ“ϋ, MAXBASE:“z—κ:•κ“ϋ - 1)

	;ƒrƒfƒIB‰e”»’θ
	IF TEQUIP:“z—κ:ƒrƒfƒIB‰e
		IF NOWEX:“z—κ:•¬“ϋ == 1
			LOCALS = MILK/
		ELSEIF NOWEX:“z—κ:•¬“ϋ == 2
			LOCALS = MILK/MILK/
		ENDIF
		TSTR:“®‰ζB‰e‹L^ += LOCALS
	ENDIF

	WAIT
