;
;Ȉ
;
@EVENTEND
	#LATER
	#DIM LOOP_CHR

	PRINTL The day has ended.
	CALL INHABITANT_FRIENDSHIP_DAYEND
	FLAG:KғstO = 0
	SIF STRLENS(TSTR:1)
		CALL SELL_VIDEO
	TRYCALL q_U蕪
	TRYCALL DPύXpb`
	TRYCALL PREGNACY_S_ANNOUNCEMENT
	TRYCALL qK_2
	FLAG:1840 = 0

	FOR LOOP_CHR, 0, CHARANUM
		TRYCALL , LOOP_CHR
		;ӂӋ
		CFLAG:LOOP_CHR:ӂ = 0
	NEXT

	;tO
	CFLAG:MASTER: = 1

	;̎𓾂ꂽ
	FOR LOOP_CHR,0,CHARANUM
		CALL JUEL_CHECK(LOOP_CHR)
		CALL DENIAL_CHECK(LOOP_CHR)
	NEXT
	BEGIN ABLUP


@CALC_JUEL(ARG, ARG:1)
#FUNCTION
VARSET LOCALS,""
SPLIT "0,1,10,100,1000,2000,3000,5000,8000,12000,25000,40000,60000,100000,150000,150000",",",LOCALS
GETPALAMLV PALAM:(ARG:1):ARG, 15
LOCAL = TOINT(LOCALS:RESULT)
SIF RESULT == 1 && PALAM:(ARG:1):ARG >= PALAMLV:1*3
	LOCAL += 1
SIF RESULT == 2 && PALAM:(ARG:1):ARG >= PALAMLV:2*3
	LOCAL += 10
SIF RESULT == 3 && PALAM:(ARG:1):ARG >= PALAMLV:3*2
	LOCAL += 100

IF ARG >= 0 && ARG <= 9
	LOCAL = LOCAL + EX:(ARG:1):ARG * 1000
ENDIF

RETURNF LOCAL

@JUEL_CHECK(z)
	#DIM z
	#DIM l
	#DIM LOOP_I
	FOR LOOP_I,0,100
		IF PALAM:z:LOOP_I < PALAMLV:1
			l = 0
		ELSEIF PALAM:z:LOOP_I < PALAMLV:1*3
			l = 1
		ELSEIF PALAM:z:LOOP_I < PALAMLV:2
			l = 2
		ELSEIF PALAM:z:LOOP_I < PALAMLV:2*3
			l = 10
		ELSEIF PALAM:z:LOOP_I < PALAMLV:3
			l = 20
		ELSEIF PALAM:z:LOOP_I < PALAMLV:3*2
			l = 100
		ELSEIF PALAM:z:LOOP_I < PALAMLV:4
			l = 200
		ELSEIF PALAM:z:LOOP_I < PALAMLV:5
			l = 1000
		ELSEIF PALAM:z:LOOP_I < PALAMLV:6
			l = 2000
		ELSEIF PALAM:z:LOOP_I < PALAMLV:7
			l = 3000
		ELSEIF PALAM:z:LOOP_I < PALAMLV:8
			l = 5000
		ELSEIF PALAM:z:LOOP_I < PALAMLV:9
			l = 8000
		ELSEIF PALAM:z:LOOP_I < PALAMLV:10
			l = 12000
		ELSEIF PALAM:z:LOOP_I < PALAMLV:11
			l = 25000
		ELSEIF PALAM:z:LOOP_I < PALAMLV:12
			l = 40000
		ELSEIF PALAM:z:LOOP_I < PALAMLV:13
			l = 60000
		ELSEIF PALAM:z:LOOP_I < PALAMLV:14
			l = 100000
		ELSE
			l = 150000
		ENDIF
		;n
		IF LOOP_I >= 0 && LOOP_I < 9
			GOTJUEL:z:LOOP_I = l + EX:z:LOOP_I * 1000
		;̑
		ELSEIF LOOP_I < 30
			GOTJUEL:z:LOOP_I = l
		;ے̎
		ELSEIF LOOP_I == 30 || LOOP_I == 31 || LOOP_I == 32
			GOTJUEL:z:100 += l
		ENDIF
	NEXT
	JUEL:z:100 += GOTJUEL:z:100
	FOR LOOP_I,0,100
		SIF !STRLENS(PALAMNAME:LOOP_I)
			CONTINUE
		SIF LOOP_I != 9 &&LOOP_I != 30 && LOOP_I != 31 && LOOP_I != 32
			JUEL:z:LOOP_I += GOTJUEL:z:LOOP_I
	NEXT

@DENIAL_CHECK(z)
	#DIM z
	#DIM l
	#DIM 
	SIF JUEL:z:100 == 0
		RETURN 0
	WHILE 1
		SIF !JUEL:z:ے || (!JUEL:z: && !JUEL:z:~ && !JUEL:z:)
			BREAK
		l = JUEL:z:ے == 1 ? 1 # JUEL:z:ے / 2
		;JUEL:10`12ŏ
		 = RAND:3 + 10
		SIF l > JUEL:z:
			l = JUEL:z:
		JUEL:z:ے -= l
		JUEL:z: -= l
	WEND
	WHILE 1
		SIF !JUEL:z:ے || (!JUEL:z:p && !JUEL:z: && !JUEL:z:| && !JUEL:z:D && !JUEL:z:Dz)
			BREAK
		l = JUEL:z:ے == 1 ? 1 # JUEL:z:ے / 2
		;JUEL:14`16ŏ
		 = RAND:5
		SELECTCASE 
			CASE 0
				 = 14
			CASE 1
				 = 15
			CASE 2
				 = 16
			CASE 3
				 = 20
			CASE 4
				 = 21
		ENDSELECT
		SIF l > JUEL:z:
			l = JUEL:z:
		JUEL:z:ے -= l
		JUEL:z: -= l
	WEND

